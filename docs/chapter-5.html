<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>nlme.utf8.md</title>
  <meta name="description" content="">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="nlme.utf8.md" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="nlme.utf8.md" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="chapter-4.html">
<link rel="next" href="chapter-6.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Chapter 1</a></li>
<li class="chapter" data-level="2" data-path="chapter-2.html"><a href="chapter-2.html"><i class="fa fa-check"></i><b>2</b> Chapter 2</a></li>
<li class="chapter" data-level="3" data-path="chapter-3.html"><a href="chapter-3.html"><i class="fa fa-check"></i><b>3</b> Chapter 3</a></li>
<li class="chapter" data-level="4" data-path="chapter-4.html"><a href="chapter-4.html"><i class="fa fa-check"></i><b>4</b> Chapter 4</a></li>
<li class="chapter" data-level="5" data-path="chapter-5.html"><a href="chapter-5.html"><i class="fa fa-check"></i><b>5</b> Chapter 5</a></li>
<li class="chapter" data-level="6" data-path="chapter-6.html"><a href="chapter-6.html"><i class="fa fa-check"></i><b>6</b> Chapter 6</a></li>
<li class="chapter" data-level="7" data-path="chapter-8.html"><a href="chapter-8.html"><i class="fa fa-check"></i><b>7</b> Chapter 8</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter-5" class="section level1">
<h1><span class="header-section-number">5</span> Chapter 5</h1>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb415-1" data-line-number="1"><span class="co">#-*- R -*-</span></a>
<a class="sourceLine" id="cb415-2" data-line-number="2"></a>
<a class="sourceLine" id="cb415-3" data-line-number="3"><span class="co"># initialization</span></a>
<a class="sourceLine" id="cb415-4" data-line-number="4"></a>
<a class="sourceLine" id="cb415-5" data-line-number="5"><span class="kw">library</span>(nlme)</a>
<a class="sourceLine" id="cb415-6" data-line-number="6"><span class="kw">options</span>(<span class="dt">width =</span> <span class="dv">65</span>, <span class="dt">digits =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb415-7" data-line-number="7"><span class="kw">options</span>(<span class="dt">contrasts =</span> <span class="kw">c</span>(<span class="dt">unordered =</span> <span class="st">&quot;contr.helmert&quot;</span>, <span class="dt">ordered =</span> <span class="st">&quot;contr.poly&quot;</span>))</a>
<a class="sourceLine" id="cb415-8" data-line-number="8"><span class="co">#pdf(file = &quot;ch05.pdf&quot;)</span></a>
<a class="sourceLine" id="cb415-9" data-line-number="9"></a>
<a class="sourceLine" id="cb415-10" data-line-number="10"><span class="co"># Chapter 5    Extending the Basic Linear Mixed-Effects Models</span></a>
<a class="sourceLine" id="cb415-11" data-line-number="11"></a>
<a class="sourceLine" id="cb415-12" data-line-number="12"><span class="co"># 5.1 General Formulation of the Extended Model</span></a>
<a class="sourceLine" id="cb415-13" data-line-number="13"></a>
<a class="sourceLine" id="cb415-14" data-line-number="14">vf1Fixed &lt;-<span class="st"> </span><span class="kw">varFixed</span>(<span class="op">~</span><span class="st"> </span>age)</a>
<a class="sourceLine" id="cb415-15" data-line-number="15">vf1Fixed &lt;-<span class="st"> </span><span class="kw">Initialize</span>(vf1Fixed, <span class="dt">data =</span> Orthodont)</a>
<a class="sourceLine" id="cb415-16" data-line-number="16"><span class="kw">varWeights</span>(vf1Fixed)</a></code></pre></div>
<pre><code>##   [1] 0.35355 0.31623 0.28868 0.26726 0.35355 0.31623 0.28868
##   [8] 0.26726 0.35355 0.31623 0.28868 0.26726 0.35355 0.31623
##  [15] 0.28868 0.26726 0.35355 0.31623 0.28868 0.26726 0.35355
##  [22] 0.31623 0.28868 0.26726 0.35355 0.31623 0.28868 0.26726
##  [29] 0.35355 0.31623 0.28868 0.26726 0.35355 0.31623 0.28868
##  [36] 0.26726 0.35355 0.31623 0.28868 0.26726 0.35355 0.31623
##  [43] 0.28868 0.26726 0.35355 0.31623 0.28868 0.26726 0.35355
##  [50] 0.31623 0.28868 0.26726 0.35355 0.31623 0.28868 0.26726
##  [57] 0.35355 0.31623 0.28868 0.26726 0.35355 0.31623 0.28868
##  [64] 0.26726 0.35355 0.31623 0.28868 0.26726 0.35355 0.31623
##  [71] 0.28868 0.26726 0.35355 0.31623 0.28868 0.26726 0.35355
##  [78] 0.31623 0.28868 0.26726 0.35355 0.31623 0.28868 0.26726
##  [85] 0.35355 0.31623 0.28868 0.26726 0.35355 0.31623 0.28868
##  [92] 0.26726 0.35355 0.31623 0.28868 0.26726 0.35355 0.31623
##  [99] 0.28868 0.26726 0.35355 0.31623 0.28868 0.26726 0.35355
## [106] 0.31623 0.28868 0.26726</code></pre>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb417-1" data-line-number="1">vf1Ident &lt;-<span class="st"> </span><span class="kw">varIdent</span>(<span class="kw">c</span>(<span class="dt">Female =</span> <span class="fl">0.5</span>), <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Sex)</a>
<a class="sourceLine" id="cb417-2" data-line-number="2">vf1Ident &lt;-<span class="st"> </span><span class="kw">Initialize</span>(vf1Ident, Orthodont)</a>
<a class="sourceLine" id="cb417-3" data-line-number="3"><span class="kw">varWeights</span>(vf1Ident)</a></code></pre></div>
<pre><code>##   Male   Male   Male   Male   Male   Male   Male   Male   Male 
##      1      1      1      1      1      1      1      1      1 
##   Male   Male   Male   Male   Male   Male   Male   Male   Male 
##      1      1      1      1      1      1      1      1      1 
##   Male   Male   Male   Male   Male   Male   Male   Male   Male 
##      1      1      1      1      1      1      1      1      1 
##   Male   Male   Male   Male   Male   Male   Male   Male   Male 
##      1      1      1      1      1      1      1      1      1 
##   Male   Male   Male   Male   Male   Male   Male   Male   Male 
##      1      1      1      1      1      1      1      1      1 
##   Male   Male   Male   Male   Male   Male   Male   Male   Male 
##      1      1      1      1      1      1      1      1      1 
##   Male   Male   Male   Male   Male   Male   Male   Male   Male 
##      1      1      1      1      1      1      1      1      1 
##   Male Female Female Female Female Female Female Female Female 
##      1      2      2      2      2      2      2      2      2 
## Female Female Female Female Female Female Female Female Female 
##      2      2      2      2      2      2      2      2      2 
## Female Female Female Female Female Female Female Female Female 
##      2      2      2      2      2      2      2      2      2 
## Female Female Female Female Female Female Female Female Female 
##      2      2      2      2      2      2      2      2      2 
## Female Female Female Female Female Female Female Female Female 
##      2      2      2      2      2      2      2      2      2</code></pre>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb419-1" data-line-number="1">vf2Ident &lt;-<span class="st"> </span><span class="kw">varIdent</span>(<span class="dt">form =</span>  <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Sex, <span class="dt">fixed =</span> <span class="kw">c</span>(<span class="dt">Female =</span> <span class="fl">0.5</span>))</a>
<a class="sourceLine" id="cb419-2" data-line-number="2">vf2Ident &lt;-<span class="st"> </span><span class="kw">Initialize</span>(vf2Ident, Orthodont)</a>
<a class="sourceLine" id="cb419-3" data-line-number="3"><span class="kw">varWeights</span>(vf2Ident)</a></code></pre></div>
<pre><code>##   Male   Male   Male   Male   Male   Male   Male   Male   Male 
##      1      1      1      1      1      1      1      1      1 
##   Male   Male   Male   Male   Male   Male   Male   Male   Male 
##      1      1      1      1      1      1      1      1      1 
##   Male   Male   Male   Male   Male   Male   Male   Male   Male 
##      1      1      1      1      1      1      1      1      1 
##   Male   Male   Male   Male   Male   Male   Male   Male   Male 
##      1      1      1      1      1      1      1      1      1 
##   Male   Male   Male   Male   Male   Male   Male   Male   Male 
##      1      1      1      1      1      1      1      1      1 
##   Male   Male   Male   Male   Male   Male   Male   Male   Male 
##      1      1      1      1      1      1      1      1      1 
##   Male   Male   Male   Male   Male   Male   Male   Male   Male 
##      1      1      1      1      1      1      1      1      1 
##   Male Female Female Female Female Female Female Female Female 
##      1      2      2      2      2      2      2      2      2 
## Female Female Female Female Female Female Female Female Female 
##      2      2      2      2      2      2      2      2      2 
## Female Female Female Female Female Female Female Female Female 
##      2      2      2      2      2      2      2      2      2 
## Female Female Female Female Female Female Female Female Female 
##      2      2      2      2      2      2      2      2      2 
## Female Female Female Female Female Female Female Female Female 
##      2      2      2      2      2      2      2      2      2</code></pre>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb421-1" data-line-number="1">vf3Ident &lt;-<span class="st"> </span><span class="kw">varIdent</span>(<span class="dt">form =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Sex <span class="op">*</span><span class="st"> </span>age)</a>
<a class="sourceLine" id="cb421-2" data-line-number="2">vf3Ident &lt;-<span class="st"> </span><span class="kw">Initialize</span>(vf3Ident, Orthodont)</a>
<a class="sourceLine" id="cb421-3" data-line-number="3"><span class="kw">varWeights</span>(vf3Ident)</a></code></pre></div>
<pre><code>##    Male*8   Male*10   Male*12   Male*14    Male*8   Male*10 
##         1         1         1         1         1         1 
##   Male*12   Male*14    Male*8   Male*10   Male*12   Male*14 
##         1         1         1         1         1         1 
##    Male*8   Male*10   Male*12   Male*14    Male*8   Male*10 
##         1         1         1         1         1         1 
##   Male*12   Male*14    Male*8   Male*10   Male*12   Male*14 
##         1         1         1         1         1         1 
##    Male*8   Male*10   Male*12   Male*14    Male*8   Male*10 
##         1         1         1         1         1         1 
##   Male*12   Male*14    Male*8   Male*10   Male*12   Male*14 
##         1         1         1         1         1         1 
##    Male*8   Male*10   Male*12   Male*14    Male*8   Male*10 
##         1         1         1         1         1         1 
##   Male*12   Male*14    Male*8   Male*10   Male*12   Male*14 
##         1         1         1         1         1         1 
##    Male*8   Male*10   Male*12   Male*14    Male*8   Male*10 
##         1         1         1         1         1         1 
##   Male*12   Male*14    Male*8   Male*10   Male*12   Male*14 
##         1         1         1         1         1         1 
##    Male*8   Male*10   Male*12   Male*14  Female*8 Female*10 
##         1         1         1         1         1         1 
## Female*12 Female*14  Female*8 Female*10 Female*12 Female*14 
##         1         1         1         1         1         1 
##  Female*8 Female*10 Female*12 Female*14  Female*8 Female*10 
##         1         1         1         1         1         1 
## Female*12 Female*14  Female*8 Female*10 Female*12 Female*14 
##         1         1         1         1         1         1 
##  Female*8 Female*10 Female*12 Female*14  Female*8 Female*10 
##         1         1         1         1         1         1 
## Female*12 Female*14  Female*8 Female*10 Female*12 Female*14 
##         1         1         1         1         1         1 
##  Female*8 Female*10 Female*12 Female*14  Female*8 Female*10 
##         1         1         1         1         1         1 
## Female*12 Female*14  Female*8 Female*10 Female*12 Female*14 
##         1         1         1         1         1         1</code></pre>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb423-1" data-line-number="1">vf1Power &lt;-<span class="st"> </span><span class="kw">varPower</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb423-2" data-line-number="2"><span class="kw">formula</span>(vf1Power)</a></code></pre></div>
<pre><code>## ~fitted(.)
## &lt;environment: 0x0000000013c5a2f0&gt;</code></pre>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb425-1" data-line-number="1">vf2Power &lt;-<span class="st"> </span><span class="kw">varPower</span>(<span class="dt">fixed =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb425-2" data-line-number="2">vf3Power &lt;-<span class="st"> </span><span class="kw">varPower</span>(<span class="dt">form =</span> <span class="op">~</span><span class="st"> </span><span class="kw">fitted</span>(.) <span class="op">|</span><span class="st"> </span>Sex,</a>
<a class="sourceLine" id="cb425-3" data-line-number="3">  <span class="dt">fixed =</span> <span class="kw">list</span>(<span class="dt">Male =</span> <span class="fl">0.5</span>, <span class="dt">Female =</span> <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb425-4" data-line-number="4">vf1Exp &lt;-<span class="st"> </span><span class="kw">varExp</span>(<span class="dt">form =</span> <span class="op">~</span><span class="st"> </span>age <span class="op">|</span><span class="st"> </span>Sex, <span class="dt">fixed =</span> <span class="kw">c</span>(<span class="dt">Female =</span> <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb425-5" data-line-number="5">vf1ConstPower &lt;-<span class="st"> </span><span class="kw">varConstPower</span>(<span class="dt">power =</span> <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb425-6" data-line-number="6">      <span class="dt">fixed =</span> <span class="kw">list</span>(<span class="dt">const =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb425-7" data-line-number="7">vf1Comb &lt;-<span class="st"> </span><span class="kw">varComb</span>(<span class="kw">varIdent</span>(<span class="kw">c</span>(<span class="dt">Female =</span> <span class="fl">0.5</span>), <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Sex),</a>
<a class="sourceLine" id="cb425-8" data-line-number="8">                     <span class="kw">varExp</span>(<span class="dv">1</span>, <span class="op">~</span><span class="st"> </span>age))</a>
<a class="sourceLine" id="cb425-9" data-line-number="9">vf1Comb &lt;-<span class="st"> </span><span class="kw">Initialize</span>(vf1Comb, Orthodont)</a>
<a class="sourceLine" id="cb425-10" data-line-number="10"><span class="kw">varWeights</span>(vf1Comb)</a></code></pre></div>
<pre><code>##   [1] 3.3546e-04 4.5400e-05 6.1442e-06 8.3153e-07 3.3546e-04
##   [6] 4.5400e-05 6.1442e-06 8.3153e-07 3.3546e-04 4.5400e-05
##  [11] 6.1442e-06 8.3153e-07 3.3546e-04 4.5400e-05 6.1442e-06
##  [16] 8.3153e-07 3.3546e-04 4.5400e-05 6.1442e-06 8.3153e-07
##  [21] 3.3546e-04 4.5400e-05 6.1442e-06 8.3153e-07 3.3546e-04
##  [26] 4.5400e-05 6.1442e-06 8.3153e-07 3.3546e-04 4.5400e-05
##  [31] 6.1442e-06 8.3153e-07 3.3546e-04 4.5400e-05 6.1442e-06
##  [36] 8.3153e-07 3.3546e-04 4.5400e-05 6.1442e-06 8.3153e-07
##  [41] 3.3546e-04 4.5400e-05 6.1442e-06 8.3153e-07 3.3546e-04
##  [46] 4.5400e-05 6.1442e-06 8.3153e-07 3.3546e-04 4.5400e-05
##  [51] 6.1442e-06 8.3153e-07 3.3546e-04 4.5400e-05 6.1442e-06
##  [56] 8.3153e-07 3.3546e-04 4.5400e-05 6.1442e-06 8.3153e-07
##  [61] 3.3546e-04 4.5400e-05 6.1442e-06 8.3153e-07 6.7093e-04
##  [66] 9.0800e-05 1.2288e-05 1.6631e-06 6.7093e-04 9.0800e-05
##  [71] 1.2288e-05 1.6631e-06 6.7093e-04 9.0800e-05 1.2288e-05
##  [76] 1.6631e-06 6.7093e-04 9.0800e-05 1.2288e-05 1.6631e-06
##  [81] 6.7093e-04 9.0800e-05 1.2288e-05 1.6631e-06 6.7093e-04
##  [86] 9.0800e-05 1.2288e-05 1.6631e-06 6.7093e-04 9.0800e-05
##  [91] 1.2288e-05 1.6631e-06 6.7093e-04 9.0800e-05 1.2288e-05
##  [96] 1.6631e-06 6.7093e-04 9.0800e-05 1.2288e-05 1.6631e-06
## [101] 6.7093e-04 9.0800e-05 1.2288e-05 1.6631e-06 6.7093e-04
## [106] 9.0800e-05 1.2288e-05 1.6631e-06</code></pre>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb427-1" data-line-number="1">fm1Dial.lme &lt;-</a>
<a class="sourceLine" id="cb427-2" data-line-number="2"><span class="st">    </span><span class="kw">lme</span>(rate <span class="op">~</span>(pressure <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(pressure<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(pressure<span class="op">^</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(pressure<span class="op">^</span><span class="dv">4</span>))<span class="op">*</span>QB,</a>
<a class="sourceLine" id="cb427-3" data-line-number="3">        Dialyzer, <span class="op">~</span><span class="st"> </span>pressure <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(pressure<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb427-4" data-line-number="4">fm1Dial.lme</a></code></pre></div>
<pre><code>## Linear mixed-effects model fit by REML
##   Data: Dialyzer 
##   Log-restricted-likelihood: -326.39
##   Fixed: rate ~ (pressure + I(pressure^2) + I(pressure^3) + I(pressure^4)) *      QB 
##       (Intercept)          pressure     I(pressure^2) 
##        -16.597990         88.673253        -42.731978 
##     I(pressure^3)     I(pressure^4)               QB1 
##          9.216490         -0.775615         -0.631728 
##      pressure:QB1 I(pressure^2):QB1 I(pressure^3):QB1 
##          0.310398          1.574171          0.050908 
## I(pressure^4):QB1 
##         -0.085964 
## 
## Random effects:
##  Formula: ~pressure + I(pressure^2) | Subject
##  Structure: General positive-definite, Log-Cholesky parametrization
##               StdDev Corr         
## (Intercept)   1.4987 (Intr) pressr
## pressure      4.9072 -0.507       
## I(pressure^2) 1.4739  0.311 -0.944
## Residual      1.8214              
## 
## Number of Observations: 140
## Number of Groups: 20</code></pre>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb429-1" data-line-number="1"><span class="kw">plot</span>(fm1Dial.lme, <span class="kw">resid</span>(.) <span class="op">~</span><span class="st"> </span>pressure, <span class="dt">abline =</span> <span class="dv">0</span>)</a></code></pre></div>
<p><img src="assets/unnamed-chunk-5-1.png" width="672" /></p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb430-1" data-line-number="1">fm2Dial.lme &lt;-<span class="st"> </span><span class="kw">update</span>(fm1Dial.lme,</a>
<a class="sourceLine" id="cb430-2" data-line-number="2">                        <span class="dt">weights =</span> <span class="kw">varPower</span>(<span class="dt">form =</span> <span class="op">~</span><span class="st"> </span>pressure))</a>
<a class="sourceLine" id="cb430-3" data-line-number="3">fm2Dial.lme</a></code></pre></div>
<pre><code>## Linear mixed-effects model fit by REML
##   Data: Dialyzer 
##   Log-restricted-likelihood: -309.51
##   Fixed: rate ~ (pressure + I(pressure^2) + I(pressure^3) + I(pressure^4)) *      QB 
##       (Intercept)          pressure     I(pressure^2) 
##         -17.67989          93.71144         -49.18679 
##     I(pressure^3)     I(pressure^4)               QB1 
##          12.24531          -1.24264          -0.92080 
##      pressure:QB1 I(pressure^2):QB1 I(pressure^3):QB1 
##           1.35310           0.48033           0.49135 
## I(pressure^4):QB1 
##          -0.14627 
## 
## Random effects:
##  Formula: ~pressure + I(pressure^2) | Subject
##  Structure: General positive-definite, Log-Cholesky parametrization
##               StdDev Corr         
## (Intercept)   1.8571 (Intr) pressr
## pressure      5.3281 -0.522       
## I(pressure^2) 1.6483  0.362 -0.954
## Residual      1.2626              
## 
## Variance function:
##  Structure: Power of variance covariate
##  Formula: ~pressure 
##  Parameter estimates:
##   power 
## 0.74933 
## Number of Observations: 140
## Number of Groups: 20</code></pre>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb432-1" data-line-number="1"><span class="kw">anova</span>(fm1Dial.lme, fm2Dial.lme)</a></code></pre></div>
<pre><code>##             Model df    AIC    BIC  logLik   Test L.Ratio
## fm1Dial.lme     1 17 686.78 735.53 -326.39               
## fm2Dial.lme     2 18 655.01 706.63 -309.51 1 vs 2   33.77
##             p-value
## fm1Dial.lme        
## fm2Dial.lme  &lt;.0001</code></pre>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb434-1" data-line-number="1"><span class="kw">plot</span>(fm2Dial.lme, <span class="kw">resid</span>(., <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>) <span class="op">~</span><span class="st"> </span>pressure,</a>
<a class="sourceLine" id="cb434-2" data-line-number="2">     <span class="dt">abline =</span> <span class="dv">0</span>)</a></code></pre></div>
<p><img src="assets/unnamed-chunk-5-2.png" width="672" /></p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb435-1" data-line-number="1"><span class="kw">intervals</span>(fm2Dial.lme)</a></code></pre></div>
<pre><code>## Approximate 95% confidence intervals
## 
##  Fixed effects:
##                       lower      est.     upper
## (Intercept)       -19.14806 -17.67989 -16.21172
## pressure           87.23117  93.71144 100.19171
## I(pressure^2)     -57.61614 -49.18679 -40.75744
## I(pressure^3)       7.96723  12.24531  16.52338
## I(pressure^4)      -1.95269  -1.24264  -0.53260
## QB1                -2.47755  -0.92080   0.63596
## pressure:QB1       -5.12717   1.35310   7.83337
## I(pressure^2):QB1  -7.94902   0.48033   8.90968
## I(pressure^3):QB1  -3.78673   0.49135   4.76942
## I(pressure^4):QB1  -0.85631  -0.14627   0.56378
## attr(,&quot;label&quot;)
## [1] &quot;Fixed effects:&quot;
## 
##  Random Effects:
##   Level: Subject 
##                                   lower     est.     upper
## sd((Intercept))                 1.25583  1.85706  2.746115
## sd(pressure)                    3.62470  5.32810  7.832007
## sd(I(pressure^2))               1.09141  1.64827  2.489272
## cor((Intercept),pressure)      -0.80266 -0.52242 -0.053226
## cor((Intercept),I(pressure^2)) -0.16526  0.36227  0.728629
## cor(pressure,I(pressure^2))    -0.98500 -0.95390 -0.862778
## 
##  Variance function:
##         lower    est.   upper
## power 0.50801 0.74933 0.99065
## attr(,&quot;label&quot;)
## [1] &quot;Variance function:&quot;
## 
##  Within-group standard error:
##  lower   est.  upper 
## 1.0607 1.2626 1.5029</code></pre>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb437-1" data-line-number="1"><span class="kw">plot</span>(fm2Dial.lme, <span class="kw">resid</span>(.) <span class="op">~</span><span class="st"> </span>pressure<span class="op">|</span>QB, <span class="dt">abline =</span> <span class="dv">0</span>)</a></code></pre></div>
<p><img src="assets/unnamed-chunk-5-3.png" width="672" /></p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb438-1" data-line-number="1">fm3Dial.lme &lt;-<span class="st"> </span><span class="kw">update</span>(fm2Dial.lme,</a>
<a class="sourceLine" id="cb438-2" data-line-number="2">                      <span class="dt">weights=</span><span class="kw">varPower</span>(<span class="dt">form =</span> <span class="op">~</span><span class="st"> </span>pressure <span class="op">|</span><span class="st"> </span>QB))</a>
<a class="sourceLine" id="cb438-3" data-line-number="3">fm3Dial.lme</a></code></pre></div>
<pre><code>## Linear mixed-effects model fit by REML
##   Data: Dialyzer 
##   Log-restricted-likelihood: -309.15
##   Fixed: rate ~ (pressure + I(pressure^2) + I(pressure^3) + I(pressure^4)) *      QB 
##       (Intercept)          pressure     I(pressure^2) 
##         -17.69504          93.75943         -49.23064 
##     I(pressure^3)     I(pressure^4)               QB1 
##          12.26045          -1.24439          -1.01692 
##      pressure:QB1 I(pressure^2):QB1 I(pressure^3):QB1 
##           1.83955          -0.19437           0.82722 
## I(pressure^4):QB1 
##          -0.20035 
## 
## Random effects:
##  Formula: ~pressure + I(pressure^2) | Subject
##  Structure: General positive-definite, Log-Cholesky parametrization
##               StdDev Corr         
## (Intercept)   1.8240 (Intr) pressr
## pressure      5.2423 -0.502       
## I(pressure^2) 1.6372  0.338 -0.951
## Residual      1.2590              
## 
## Variance function:
##  Structure: Power of variance covariate, different strata
##  Formula: ~pressure | QB 
##  Parameter estimates:
##     200     300 
## 0.64775 0.83780 
## Number of Observations: 140
## Number of Groups: 20</code></pre>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb440-1" data-line-number="1"><span class="kw">anova</span>(fm2Dial.lme, fm3Dial.lme)</a></code></pre></div>
<pre><code>##             Model df    AIC    BIC  logLik   Test L.Ratio
## fm2Dial.lme     1 18 655.01 706.63 -309.51               
## fm3Dial.lme     2 19 656.30 710.78 -309.15 1 vs 2 0.71091
##             p-value
## fm2Dial.lme        
## fm3Dial.lme  0.3991</code></pre>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb442-1" data-line-number="1">fm4Dial.lme &lt;-<span class="st"> </span><span class="kw">update</span>(fm2Dial.lme,</a>
<a class="sourceLine" id="cb442-2" data-line-number="2">                      <span class="dt">weights =</span> <span class="kw">varConstPower</span>(<span class="dt">form =</span> <span class="op">~</span><span class="st"> </span>pressure))</a>
<a class="sourceLine" id="cb442-3" data-line-number="3"><span class="kw">anova</span>(fm2Dial.lme, fm4Dial.lme)</a></code></pre></div>
<pre><code>##             Model df    AIC    BIC  logLik   Test L.Ratio
## fm2Dial.lme     1 18 655.01 706.63 -309.51               
## fm4Dial.lme     2 19 656.85 711.34 -309.43 1 vs 2 0.15915
##             p-value
## fm2Dial.lme        
## fm4Dial.lme  0.6899</code></pre>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb444-1" data-line-number="1"><span class="kw">plot</span>(<span class="kw">augPred</span>(fm2Dial.lme), <span class="dt">grid =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="assets/unnamed-chunk-5-4.png" width="672" /></p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb445-1" data-line-number="1"><span class="kw">anova</span>(fm2Dial.lme)</a></code></pre></div>
<pre><code>##                  numDF denDF F-value p-value
## (Intercept)          1   112  552.98  &lt;.0001
## pressure             1   112 2328.82  &lt;.0001
## I(pressure^2)        1   112 1174.68  &lt;.0001
## I(pressure^3)        1   112  359.92  &lt;.0001
## I(pressure^4)        1   112   12.47  0.0006
## QB                   1    18    4.83  0.0414
## pressure:QB          1   112   80.11  &lt;.0001
## I(pressure^2):QB     1   112    1.35  0.2476
## I(pressure^3):QB     1   112    2.24  0.1370
## I(pressure^4):QB     1   112    0.17  0.6839</code></pre>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb447-1" data-line-number="1"><span class="kw">anova</span>(fm2Dial.lme, <span class="dt">Terms =</span> <span class="dv">8</span><span class="op">:</span><span class="dv">10</span>)</a></code></pre></div>
<pre><code>## F-test for: I(pressure^2):QB, I(pressure^3):QB, I(pressure^4):QB 
##   numDF denDF F-value p-value
## 1     3   112  1.2535  0.2939</code></pre>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb449-1" data-line-number="1"><span class="kw">options</span>(<span class="dt">contrasts =</span> <span class="kw">c</span>(<span class="st">&quot;contr.treatment&quot;</span>, <span class="st">&quot;contr.poly&quot;</span>))</a>
<a class="sourceLine" id="cb449-2" data-line-number="2">fm1BW.lme &lt;-<span class="st"> </span><span class="kw">lme</span>(weight <span class="op">~</span><span class="st"> </span>Time <span class="op">*</span><span class="st"> </span>Diet, BodyWeight,</a>
<a class="sourceLine" id="cb449-3" data-line-number="3">                   <span class="dt">random =</span> <span class="op">~</span><span class="st"> </span>Time)</a>
<a class="sourceLine" id="cb449-4" data-line-number="4">fm1BW.lme</a></code></pre></div>
<pre><code>## Linear mixed-effects model fit by REML
##   Data: BodyWeight 
##   Log-restricted-likelihood: -575.86
##   Fixed: weight ~ Time * Diet 
## (Intercept)        Time       Diet2       Diet3  Time:Diet2 
##   251.65165     0.35964   200.66549   252.07168     0.60584 
##  Time:Diet3 
##     0.29834 
## 
## Random effects:
##  Formula: ~Time | Rat
##  Structure: General positive-definite, Log-Cholesky parametrization
##             StdDev   Corr  
## (Intercept) 36.93907 (Intr)
## Time         0.24841 -0.149
## Residual     4.44361       
## 
## Number of Observations: 176
## Number of Groups: 16</code></pre>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb451-1" data-line-number="1">fm2BW.lme &lt;-<span class="st"> </span><span class="kw">update</span>(fm1BW.lme, <span class="dt">weights =</span> <span class="kw">varPower</span>())</a>
<a class="sourceLine" id="cb451-2" data-line-number="2">fm2BW.lme</a></code></pre></div>
<pre><code>## Linear mixed-effects model fit by REML
##   Data: BodyWeight 
##   Log-restricted-likelihood: -570.96
##   Fixed: weight ~ Time * Diet 
## (Intercept)        Time       Diet2       Diet3  Time:Diet2 
##   251.60215     0.36109   200.77697   252.17017     0.60183 
##  Time:Diet3 
##     0.29524 
## 
## Random effects:
##  Formula: ~Time | Rat
##  Structure: General positive-definite, Log-Cholesky parametrization
##             StdDev   Corr  
## (Intercept) 36.89802 (Intr)
## Time         0.24365 -0.145
## Residual     0.17517       
## 
## Variance function:
##  Structure: Power of variance covariate
##  Formula: ~fitted(.) 
##  Parameter estimates:
##   power 
## 0.54284 
## Number of Observations: 176
## Number of Groups: 16</code></pre>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb453-1" data-line-number="1"><span class="kw">anova</span>(fm1BW.lme, fm2BW.lme)</a></code></pre></div>
<pre><code>##           Model df    AIC    BIC  logLik   Test L.Ratio p-value
## fm1BW.lme     1 10 1171.7 1203.1 -575.86                       
## fm2BW.lme     2 11 1163.9 1198.4 -570.96 1 vs 2  9.7983  0.0017</code></pre>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb455-1" data-line-number="1"><span class="kw">summary</span>(fm2BW.lme)</a></code></pre></div>
<pre><code>## Linear mixed-effects model fit by REML
##  Data: BodyWeight 
##      AIC    BIC  logLik
##   1163.9 1198.4 -570.96
## 
## Random effects:
##  Formula: ~Time | Rat
##  Structure: General positive-definite, Log-Cholesky parametrization
##             StdDev   Corr  
## (Intercept) 36.89802 (Intr)
## Time         0.24365 -0.145
## Residual     0.17517       
## 
## Variance function:
##  Structure: Power of variance covariate
##  Formula: ~fitted(.) 
##  Parameter estimates:
##   power 
## 0.54284 
## Fixed effects: weight ~ Time * Diet 
##               Value Std.Error  DF t-value p-value
## (Intercept) 251.602   13.0673 157 19.2543  0.0000
## Time          0.361    0.0884 157  4.0857  0.0001
## Diet2       200.777   22.6562  13  8.8619  0.0000
## Diet3       252.170   22.6616  13 11.1276  0.0000
## Time:Diet2    0.602    0.1554 157  3.8722  0.0002
## Time:Diet3    0.295    0.1559 157  1.8938  0.0601
##  Correlation: 
##            (Intr) Time   Diet2  Diet3  Tm:Dt2
## Time       -0.152                            
## Diet2      -0.577  0.088                     
## Diet3      -0.577  0.088  0.333              
## Time:Diet2  0.087 -0.569 -0.157 -0.050       
## Time:Diet3  0.086 -0.567 -0.050 -0.158  0.322
## 
## Standardized Within-Group Residuals:
##       Min        Q1       Med        Q3       Max 
## -2.937368 -0.443866  0.079864  0.580848  2.264898 
## 
## Number of Observations: 176
## Number of Groups: 16</code></pre>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb457-1" data-line-number="1"><span class="kw">anova</span>(fm2BW.lme, <span class="dt">L =</span> <span class="kw">c</span>(<span class="st">&quot;Time:Diet2&quot;</span> =<span class="st"> </span><span class="dv">1</span>, <span class="st">&quot;Time:Diet3&quot;</span> =<span class="st"> </span><span class="dv">-1</span>))</a></code></pre></div>
<pre><code>## F-test for linear combination(s)
## Time:Diet2 Time:Diet3 
##          1         -1 
##   numDF denDF F-value p-value
## 1     1   157  2.8626  0.0926</code></pre>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb459-1" data-line-number="1">cs1CompSymm &lt;-<span class="st"> </span><span class="kw">corCompSymm</span>(<span class="dt">value =</span> <span class="fl">0.3</span>, <span class="dt">form =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Subject)</a>
<a class="sourceLine" id="cb459-2" data-line-number="2">cs2CompSymm &lt;-<span class="st"> </span><span class="kw">corCompSymm</span>(<span class="dt">value =</span> <span class="fl">0.3</span>, <span class="dt">form =</span> <span class="op">~</span><span class="st"> </span>age <span class="op">|</span><span class="st"> </span>Subject)</a>
<a class="sourceLine" id="cb459-3" data-line-number="3">cs1CompSymm &lt;-<span class="st"> </span><span class="kw">Initialize</span>(cs1CompSymm, <span class="dt">data =</span> Orthodont)</a>
<a class="sourceLine" id="cb459-4" data-line-number="4"><span class="kw">corMatrix</span>(cs1CompSymm)</a></code></pre></div>
<pre><code>## $M01
##      [,1] [,2] [,3] [,4]
## [1,]  1.0  0.3  0.3  0.3
## [2,]  0.3  1.0  0.3  0.3
## [3,]  0.3  0.3  1.0  0.3
## [4,]  0.3  0.3  0.3  1.0
## 
## $M02
##      [,1] [,2] [,3] [,4]
## [1,]  1.0  0.3  0.3  0.3
## [2,]  0.3  1.0  0.3  0.3
## [3,]  0.3  0.3  1.0  0.3
## [4,]  0.3  0.3  0.3  1.0
## 
## $M03
##      [,1] [,2] [,3] [,4]
## [1,]  1.0  0.3  0.3  0.3
## [2,]  0.3  1.0  0.3  0.3
## [3,]  0.3  0.3  1.0  0.3
## [4,]  0.3  0.3  0.3  1.0
## 
## $M04
##      [,1] [,2] [,3] [,4]
## [1,]  1.0  0.3  0.3  0.3
## [2,]  0.3  1.0  0.3  0.3
## [3,]  0.3  0.3  1.0  0.3
## [4,]  0.3  0.3  0.3  1.0
## 
## $M05
##      [,1] [,2] [,3] [,4]
## [1,]  1.0  0.3  0.3  0.3
## [2,]  0.3  1.0  0.3  0.3
## [3,]  0.3  0.3  1.0  0.3
## [4,]  0.3  0.3  0.3  1.0
## 
## $M06
##      [,1] [,2] [,3] [,4]
## [1,]  1.0  0.3  0.3  0.3
## [2,]  0.3  1.0  0.3  0.3
## [3,]  0.3  0.3  1.0  0.3
## [4,]  0.3  0.3  0.3  1.0
## 
## $M07
##      [,1] [,2] [,3] [,4]
## [1,]  1.0  0.3  0.3  0.3
## [2,]  0.3  1.0  0.3  0.3
## [3,]  0.3  0.3  1.0  0.3
## [4,]  0.3  0.3  0.3  1.0
## 
## $M08
##      [,1] [,2] [,3] [,4]
## [1,]  1.0  0.3  0.3  0.3
## [2,]  0.3  1.0  0.3  0.3
## [3,]  0.3  0.3  1.0  0.3
## [4,]  0.3  0.3  0.3  1.0
## 
## $M09
##      [,1] [,2] [,3] [,4]
## [1,]  1.0  0.3  0.3  0.3
## [2,]  0.3  1.0  0.3  0.3
## [3,]  0.3  0.3  1.0  0.3
## [4,]  0.3  0.3  0.3  1.0
## 
## $M10
##      [,1] [,2] [,3] [,4]
## [1,]  1.0  0.3  0.3  0.3
## [2,]  0.3  1.0  0.3  0.3
## [3,]  0.3  0.3  1.0  0.3
## [4,]  0.3  0.3  0.3  1.0
## 
## $M11
##      [,1] [,2] [,3] [,4]
## [1,]  1.0  0.3  0.3  0.3
## [2,]  0.3  1.0  0.3  0.3
## [3,]  0.3  0.3  1.0  0.3
## [4,]  0.3  0.3  0.3  1.0
## 
## $M12
##      [,1] [,2] [,3] [,4]
## [1,]  1.0  0.3  0.3  0.3
## [2,]  0.3  1.0  0.3  0.3
## [3,]  0.3  0.3  1.0  0.3
## [4,]  0.3  0.3  0.3  1.0
## 
## $M13
##      [,1] [,2] [,3] [,4]
## [1,]  1.0  0.3  0.3  0.3
## [2,]  0.3  1.0  0.3  0.3
## [3,]  0.3  0.3  1.0  0.3
## [4,]  0.3  0.3  0.3  1.0
## 
## $M14
##      [,1] [,2] [,3] [,4]
## [1,]  1.0  0.3  0.3  0.3
## [2,]  0.3  1.0  0.3  0.3
## [3,]  0.3  0.3  1.0  0.3
## [4,]  0.3  0.3  0.3  1.0
## 
## $M15
##      [,1] [,2] [,3] [,4]
## [1,]  1.0  0.3  0.3  0.3
## [2,]  0.3  1.0  0.3  0.3
## [3,]  0.3  0.3  1.0  0.3
## [4,]  0.3  0.3  0.3  1.0
## 
## $M16
##      [,1] [,2] [,3] [,4]
## [1,]  1.0  0.3  0.3  0.3
## [2,]  0.3  1.0  0.3  0.3
## [3,]  0.3  0.3  1.0  0.3
## [4,]  0.3  0.3  0.3  1.0
## 
## $F01
##      [,1] [,2] [,3] [,4]
## [1,]  1.0  0.3  0.3  0.3
## [2,]  0.3  1.0  0.3  0.3
## [3,]  0.3  0.3  1.0  0.3
## [4,]  0.3  0.3  0.3  1.0
## 
## $F02
##      [,1] [,2] [,3] [,4]
## [1,]  1.0  0.3  0.3  0.3
## [2,]  0.3  1.0  0.3  0.3
## [3,]  0.3  0.3  1.0  0.3
## [4,]  0.3  0.3  0.3  1.0
## 
## $F03
##      [,1] [,2] [,3] [,4]
## [1,]  1.0  0.3  0.3  0.3
## [2,]  0.3  1.0  0.3  0.3
## [3,]  0.3  0.3  1.0  0.3
## [4,]  0.3  0.3  0.3  1.0
## 
## $F04
##      [,1] [,2] [,3] [,4]
## [1,]  1.0  0.3  0.3  0.3
## [2,]  0.3  1.0  0.3  0.3
## [3,]  0.3  0.3  1.0  0.3
## [4,]  0.3  0.3  0.3  1.0
## 
## $F05
##      [,1] [,2] [,3] [,4]
## [1,]  1.0  0.3  0.3  0.3
## [2,]  0.3  1.0  0.3  0.3
## [3,]  0.3  0.3  1.0  0.3
## [4,]  0.3  0.3  0.3  1.0
## 
## $F06
##      [,1] [,2] [,3] [,4]
## [1,]  1.0  0.3  0.3  0.3
## [2,]  0.3  1.0  0.3  0.3
## [3,]  0.3  0.3  1.0  0.3
## [4,]  0.3  0.3  0.3  1.0
## 
## $F07
##      [,1] [,2] [,3] [,4]
## [1,]  1.0  0.3  0.3  0.3
## [2,]  0.3  1.0  0.3  0.3
## [3,]  0.3  0.3  1.0  0.3
## [4,]  0.3  0.3  0.3  1.0
## 
## $F08
##      [,1] [,2] [,3] [,4]
## [1,]  1.0  0.3  0.3  0.3
## [2,]  0.3  1.0  0.3  0.3
## [3,]  0.3  0.3  1.0  0.3
## [4,]  0.3  0.3  0.3  1.0
## 
## $F09
##      [,1] [,2] [,3] [,4]
## [1,]  1.0  0.3  0.3  0.3
## [2,]  0.3  1.0  0.3  0.3
## [3,]  0.3  0.3  1.0  0.3
## [4,]  0.3  0.3  0.3  1.0
## 
## $F10
##      [,1] [,2] [,3] [,4]
## [1,]  1.0  0.3  0.3  0.3
## [2,]  0.3  1.0  0.3  0.3
## [3,]  0.3  0.3  1.0  0.3
## [4,]  0.3  0.3  0.3  1.0
## 
## $F11
##      [,1] [,2] [,3] [,4]
## [1,]  1.0  0.3  0.3  0.3
## [2,]  0.3  1.0  0.3  0.3
## [3,]  0.3  0.3  1.0  0.3
## [4,]  0.3  0.3  0.3  1.0</code></pre>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb461-1" data-line-number="1">cs1Symm &lt;-<span class="st"> </span><span class="kw">corSymm</span>(<span class="dt">value =</span> <span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">-0.1</span>, <span class="dv">0</span>, <span class="fl">0.2</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb461-2" data-line-number="2">                   <span class="dt">form =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Subject)</a>
<a class="sourceLine" id="cb461-3" data-line-number="3">cs1Symm &lt;-<span class="st"> </span><span class="kw">Initialize</span>(cs1Symm, <span class="dt">data =</span> Orthodont)</a>
<a class="sourceLine" id="cb461-4" data-line-number="4"><span class="kw">corMatrix</span>(cs1Symm)</a></code></pre></div>
<pre><code>## $M01
##      [,1]       [,2]        [,3]        [,4]
## [1,]  1.0 2.0000e-01  1.0000e-01 -1.0000e-01
## [2,]  0.2 1.0000e+00  9.0206e-17  2.0000e-01
## [3,]  0.1 9.0206e-17  1.0000e+00 -1.0408e-16
## [4,] -0.1 2.0000e-01 -1.0408e-16  1.0000e+00
## 
## $M02
##      [,1]       [,2]        [,3]        [,4]
## [1,]  1.0 2.0000e-01  1.0000e-01 -1.0000e-01
## [2,]  0.2 1.0000e+00  9.0206e-17  2.0000e-01
## [3,]  0.1 9.0206e-17  1.0000e+00 -1.0408e-16
## [4,] -0.1 2.0000e-01 -1.0408e-16  1.0000e+00
## 
## $M03
##      [,1]       [,2]        [,3]        [,4]
## [1,]  1.0 2.0000e-01  1.0000e-01 -1.0000e-01
## [2,]  0.2 1.0000e+00  9.0206e-17  2.0000e-01
## [3,]  0.1 9.0206e-17  1.0000e+00 -1.0408e-16
## [4,] -0.1 2.0000e-01 -1.0408e-16  1.0000e+00
## 
## $M04
##      [,1]       [,2]        [,3]        [,4]
## [1,]  1.0 2.0000e-01  1.0000e-01 -1.0000e-01
## [2,]  0.2 1.0000e+00  9.0206e-17  2.0000e-01
## [3,]  0.1 9.0206e-17  1.0000e+00 -1.0408e-16
## [4,] -0.1 2.0000e-01 -1.0408e-16  1.0000e+00
## 
## $M05
##      [,1]       [,2]        [,3]        [,4]
## [1,]  1.0 2.0000e-01  1.0000e-01 -1.0000e-01
## [2,]  0.2 1.0000e+00  9.0206e-17  2.0000e-01
## [3,]  0.1 9.0206e-17  1.0000e+00 -1.0408e-16
## [4,] -0.1 2.0000e-01 -1.0408e-16  1.0000e+00
## 
## $M06
##      [,1]       [,2]        [,3]        [,4]
## [1,]  1.0 2.0000e-01  1.0000e-01 -1.0000e-01
## [2,]  0.2 1.0000e+00  9.0206e-17  2.0000e-01
## [3,]  0.1 9.0206e-17  1.0000e+00 -1.0408e-16
## [4,] -0.1 2.0000e-01 -1.0408e-16  1.0000e+00
## 
## $M07
##      [,1]       [,2]        [,3]        [,4]
## [1,]  1.0 2.0000e-01  1.0000e-01 -1.0000e-01
## [2,]  0.2 1.0000e+00  9.0206e-17  2.0000e-01
## [3,]  0.1 9.0206e-17  1.0000e+00 -1.0408e-16
## [4,] -0.1 2.0000e-01 -1.0408e-16  1.0000e+00
## 
## $M08
##      [,1]       [,2]        [,3]        [,4]
## [1,]  1.0 2.0000e-01  1.0000e-01 -1.0000e-01
## [2,]  0.2 1.0000e+00  9.0206e-17  2.0000e-01
## [3,]  0.1 9.0206e-17  1.0000e+00 -1.0408e-16
## [4,] -0.1 2.0000e-01 -1.0408e-16  1.0000e+00
## 
## $M09
##      [,1]       [,2]        [,3]        [,4]
## [1,]  1.0 2.0000e-01  1.0000e-01 -1.0000e-01
## [2,]  0.2 1.0000e+00  9.0206e-17  2.0000e-01
## [3,]  0.1 9.0206e-17  1.0000e+00 -1.0408e-16
## [4,] -0.1 2.0000e-01 -1.0408e-16  1.0000e+00
## 
## $M10
##      [,1]       [,2]        [,3]        [,4]
## [1,]  1.0 2.0000e-01  1.0000e-01 -1.0000e-01
## [2,]  0.2 1.0000e+00  9.0206e-17  2.0000e-01
## [3,]  0.1 9.0206e-17  1.0000e+00 -1.0408e-16
## [4,] -0.1 2.0000e-01 -1.0408e-16  1.0000e+00
## 
## $M11
##      [,1]       [,2]        [,3]        [,4]
## [1,]  1.0 2.0000e-01  1.0000e-01 -1.0000e-01
## [2,]  0.2 1.0000e+00  9.0206e-17  2.0000e-01
## [3,]  0.1 9.0206e-17  1.0000e+00 -1.0408e-16
## [4,] -0.1 2.0000e-01 -1.0408e-16  1.0000e+00
## 
## $M12
##      [,1]       [,2]        [,3]        [,4]
## [1,]  1.0 2.0000e-01  1.0000e-01 -1.0000e-01
## [2,]  0.2 1.0000e+00  9.0206e-17  2.0000e-01
## [3,]  0.1 9.0206e-17  1.0000e+00 -1.0408e-16
## [4,] -0.1 2.0000e-01 -1.0408e-16  1.0000e+00
## 
## $M13
##      [,1]       [,2]        [,3]        [,4]
## [1,]  1.0 2.0000e-01  1.0000e-01 -1.0000e-01
## [2,]  0.2 1.0000e+00  9.0206e-17  2.0000e-01
## [3,]  0.1 9.0206e-17  1.0000e+00 -1.0408e-16
## [4,] -0.1 2.0000e-01 -1.0408e-16  1.0000e+00
## 
## $M14
##      [,1]       [,2]        [,3]        [,4]
## [1,]  1.0 2.0000e-01  1.0000e-01 -1.0000e-01
## [2,]  0.2 1.0000e+00  9.0206e-17  2.0000e-01
## [3,]  0.1 9.0206e-17  1.0000e+00 -1.0408e-16
## [4,] -0.1 2.0000e-01 -1.0408e-16  1.0000e+00
## 
## $M15
##      [,1]       [,2]        [,3]        [,4]
## [1,]  1.0 2.0000e-01  1.0000e-01 -1.0000e-01
## [2,]  0.2 1.0000e+00  9.0206e-17  2.0000e-01
## [3,]  0.1 9.0206e-17  1.0000e+00 -1.0408e-16
## [4,] -0.1 2.0000e-01 -1.0408e-16  1.0000e+00
## 
## $M16
##      [,1]       [,2]        [,3]        [,4]
## [1,]  1.0 2.0000e-01  1.0000e-01 -1.0000e-01
## [2,]  0.2 1.0000e+00  9.0206e-17  2.0000e-01
## [3,]  0.1 9.0206e-17  1.0000e+00 -1.0408e-16
## [4,] -0.1 2.0000e-01 -1.0408e-16  1.0000e+00
## 
## $F01
##      [,1]       [,2]        [,3]        [,4]
## [1,]  1.0 2.0000e-01  1.0000e-01 -1.0000e-01
## [2,]  0.2 1.0000e+00  9.0206e-17  2.0000e-01
## [3,]  0.1 9.0206e-17  1.0000e+00 -1.0408e-16
## [4,] -0.1 2.0000e-01 -1.0408e-16  1.0000e+00
## 
## $F02
##      [,1]       [,2]        [,3]        [,4]
## [1,]  1.0 2.0000e-01  1.0000e-01 -1.0000e-01
## [2,]  0.2 1.0000e+00  9.0206e-17  2.0000e-01
## [3,]  0.1 9.0206e-17  1.0000e+00 -1.0408e-16
## [4,] -0.1 2.0000e-01 -1.0408e-16  1.0000e+00
## 
## $F03
##      [,1]       [,2]        [,3]        [,4]
## [1,]  1.0 2.0000e-01  1.0000e-01 -1.0000e-01
## [2,]  0.2 1.0000e+00  9.0206e-17  2.0000e-01
## [3,]  0.1 9.0206e-17  1.0000e+00 -1.0408e-16
## [4,] -0.1 2.0000e-01 -1.0408e-16  1.0000e+00
## 
## $F04
##      [,1]       [,2]        [,3]        [,4]
## [1,]  1.0 2.0000e-01  1.0000e-01 -1.0000e-01
## [2,]  0.2 1.0000e+00  9.0206e-17  2.0000e-01
## [3,]  0.1 9.0206e-17  1.0000e+00 -1.0408e-16
## [4,] -0.1 2.0000e-01 -1.0408e-16  1.0000e+00
## 
## $F05
##      [,1]       [,2]        [,3]        [,4]
## [1,]  1.0 2.0000e-01  1.0000e-01 -1.0000e-01
## [2,]  0.2 1.0000e+00  9.0206e-17  2.0000e-01
## [3,]  0.1 9.0206e-17  1.0000e+00 -1.0408e-16
## [4,] -0.1 2.0000e-01 -1.0408e-16  1.0000e+00
## 
## $F06
##      [,1]       [,2]        [,3]        [,4]
## [1,]  1.0 2.0000e-01  1.0000e-01 -1.0000e-01
## [2,]  0.2 1.0000e+00  9.0206e-17  2.0000e-01
## [3,]  0.1 9.0206e-17  1.0000e+00 -1.0408e-16
## [4,] -0.1 2.0000e-01 -1.0408e-16  1.0000e+00
## 
## $F07
##      [,1]       [,2]        [,3]        [,4]
## [1,]  1.0 2.0000e-01  1.0000e-01 -1.0000e-01
## [2,]  0.2 1.0000e+00  9.0206e-17  2.0000e-01
## [3,]  0.1 9.0206e-17  1.0000e+00 -1.0408e-16
## [4,] -0.1 2.0000e-01 -1.0408e-16  1.0000e+00
## 
## $F08
##      [,1]       [,2]        [,3]        [,4]
## [1,]  1.0 2.0000e-01  1.0000e-01 -1.0000e-01
## [2,]  0.2 1.0000e+00  9.0206e-17  2.0000e-01
## [3,]  0.1 9.0206e-17  1.0000e+00 -1.0408e-16
## [4,] -0.1 2.0000e-01 -1.0408e-16  1.0000e+00
## 
## $F09
##      [,1]       [,2]        [,3]        [,4]
## [1,]  1.0 2.0000e-01  1.0000e-01 -1.0000e-01
## [2,]  0.2 1.0000e+00  9.0206e-17  2.0000e-01
## [3,]  0.1 9.0206e-17  1.0000e+00 -1.0408e-16
## [4,] -0.1 2.0000e-01 -1.0408e-16  1.0000e+00
## 
## $F10
##      [,1]       [,2]        [,3]        [,4]
## [1,]  1.0 2.0000e-01  1.0000e-01 -1.0000e-01
## [2,]  0.2 1.0000e+00  9.0206e-17  2.0000e-01
## [3,]  0.1 9.0206e-17  1.0000e+00 -1.0408e-16
## [4,] -0.1 2.0000e-01 -1.0408e-16  1.0000e+00
## 
## $F11
##      [,1]       [,2]        [,3]        [,4]
## [1,]  1.0 2.0000e-01  1.0000e-01 -1.0000e-01
## [2,]  0.2 1.0000e+00  9.0206e-17  2.0000e-01
## [3,]  0.1 9.0206e-17  1.0000e+00 -1.0408e-16
## [4,] -0.1 2.0000e-01 -1.0408e-16  1.0000e+00</code></pre>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb463-1" data-line-number="1">cs1AR1 &lt;-<span class="st"> </span><span class="kw">corAR1</span>(<span class="fl">0.8</span>, <span class="dt">form =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Subject)</a>
<a class="sourceLine" id="cb463-2" data-line-number="2">cs1AR1 &lt;-<span class="st"> </span><span class="kw">Initialize</span>(cs1AR1, <span class="dt">data =</span> Orthodont)</a>
<a class="sourceLine" id="cb463-3" data-line-number="3"><span class="kw">corMatrix</span>(cs1AR1)</a></code></pre></div>
<pre><code>## $M01
##       [,1] [,2] [,3]  [,4]
## [1,] 1.000 0.80 0.64 0.512
## [2,] 0.800 1.00 0.80 0.640
## [3,] 0.640 0.80 1.00 0.800
## [4,] 0.512 0.64 0.80 1.000
## 
## $M02
##       [,1] [,2] [,3]  [,4]
## [1,] 1.000 0.80 0.64 0.512
## [2,] 0.800 1.00 0.80 0.640
## [3,] 0.640 0.80 1.00 0.800
## [4,] 0.512 0.64 0.80 1.000
## 
## $M03
##       [,1] [,2] [,3]  [,4]
## [1,] 1.000 0.80 0.64 0.512
## [2,] 0.800 1.00 0.80 0.640
## [3,] 0.640 0.80 1.00 0.800
## [4,] 0.512 0.64 0.80 1.000
## 
## $M04
##       [,1] [,2] [,3]  [,4]
## [1,] 1.000 0.80 0.64 0.512
## [2,] 0.800 1.00 0.80 0.640
## [3,] 0.640 0.80 1.00 0.800
## [4,] 0.512 0.64 0.80 1.000
## 
## $M05
##       [,1] [,2] [,3]  [,4]
## [1,] 1.000 0.80 0.64 0.512
## [2,] 0.800 1.00 0.80 0.640
## [3,] 0.640 0.80 1.00 0.800
## [4,] 0.512 0.64 0.80 1.000
## 
## $M06
##       [,1] [,2] [,3]  [,4]
## [1,] 1.000 0.80 0.64 0.512
## [2,] 0.800 1.00 0.80 0.640
## [3,] 0.640 0.80 1.00 0.800
## [4,] 0.512 0.64 0.80 1.000
## 
## $M07
##       [,1] [,2] [,3]  [,4]
## [1,] 1.000 0.80 0.64 0.512
## [2,] 0.800 1.00 0.80 0.640
## [3,] 0.640 0.80 1.00 0.800
## [4,] 0.512 0.64 0.80 1.000
## 
## $M08
##       [,1] [,2] [,3]  [,4]
## [1,] 1.000 0.80 0.64 0.512
## [2,] 0.800 1.00 0.80 0.640
## [3,] 0.640 0.80 1.00 0.800
## [4,] 0.512 0.64 0.80 1.000
## 
## $M09
##       [,1] [,2] [,3]  [,4]
## [1,] 1.000 0.80 0.64 0.512
## [2,] 0.800 1.00 0.80 0.640
## [3,] 0.640 0.80 1.00 0.800
## [4,] 0.512 0.64 0.80 1.000
## 
## $M10
##       [,1] [,2] [,3]  [,4]
## [1,] 1.000 0.80 0.64 0.512
## [2,] 0.800 1.00 0.80 0.640
## [3,] 0.640 0.80 1.00 0.800
## [4,] 0.512 0.64 0.80 1.000
## 
## $M11
##       [,1] [,2] [,3]  [,4]
## [1,] 1.000 0.80 0.64 0.512
## [2,] 0.800 1.00 0.80 0.640
## [3,] 0.640 0.80 1.00 0.800
## [4,] 0.512 0.64 0.80 1.000
## 
## $M12
##       [,1] [,2] [,3]  [,4]
## [1,] 1.000 0.80 0.64 0.512
## [2,] 0.800 1.00 0.80 0.640
## [3,] 0.640 0.80 1.00 0.800
## [4,] 0.512 0.64 0.80 1.000
## 
## $M13
##       [,1] [,2] [,3]  [,4]
## [1,] 1.000 0.80 0.64 0.512
## [2,] 0.800 1.00 0.80 0.640
## [3,] 0.640 0.80 1.00 0.800
## [4,] 0.512 0.64 0.80 1.000
## 
## $M14
##       [,1] [,2] [,3]  [,4]
## [1,] 1.000 0.80 0.64 0.512
## [2,] 0.800 1.00 0.80 0.640
## [3,] 0.640 0.80 1.00 0.800
## [4,] 0.512 0.64 0.80 1.000
## 
## $M15
##       [,1] [,2] [,3]  [,4]
## [1,] 1.000 0.80 0.64 0.512
## [2,] 0.800 1.00 0.80 0.640
## [3,] 0.640 0.80 1.00 0.800
## [4,] 0.512 0.64 0.80 1.000
## 
## $M16
##       [,1] [,2] [,3]  [,4]
## [1,] 1.000 0.80 0.64 0.512
## [2,] 0.800 1.00 0.80 0.640
## [3,] 0.640 0.80 1.00 0.800
## [4,] 0.512 0.64 0.80 1.000
## 
## $F01
##       [,1] [,2] [,3]  [,4]
## [1,] 1.000 0.80 0.64 0.512
## [2,] 0.800 1.00 0.80 0.640
## [3,] 0.640 0.80 1.00 0.800
## [4,] 0.512 0.64 0.80 1.000
## 
## $F02
##       [,1] [,2] [,3]  [,4]
## [1,] 1.000 0.80 0.64 0.512
## [2,] 0.800 1.00 0.80 0.640
## [3,] 0.640 0.80 1.00 0.800
## [4,] 0.512 0.64 0.80 1.000
## 
## $F03
##       [,1] [,2] [,3]  [,4]
## [1,] 1.000 0.80 0.64 0.512
## [2,] 0.800 1.00 0.80 0.640
## [3,] 0.640 0.80 1.00 0.800
## [4,] 0.512 0.64 0.80 1.000
## 
## $F04
##       [,1] [,2] [,3]  [,4]
## [1,] 1.000 0.80 0.64 0.512
## [2,] 0.800 1.00 0.80 0.640
## [3,] 0.640 0.80 1.00 0.800
## [4,] 0.512 0.64 0.80 1.000
## 
## $F05
##       [,1] [,2] [,3]  [,4]
## [1,] 1.000 0.80 0.64 0.512
## [2,] 0.800 1.00 0.80 0.640
## [3,] 0.640 0.80 1.00 0.800
## [4,] 0.512 0.64 0.80 1.000
## 
## $F06
##       [,1] [,2] [,3]  [,4]
## [1,] 1.000 0.80 0.64 0.512
## [2,] 0.800 1.00 0.80 0.640
## [3,] 0.640 0.80 1.00 0.800
## [4,] 0.512 0.64 0.80 1.000
## 
## $F07
##       [,1] [,2] [,3]  [,4]
## [1,] 1.000 0.80 0.64 0.512
## [2,] 0.800 1.00 0.80 0.640
## [3,] 0.640 0.80 1.00 0.800
## [4,] 0.512 0.64 0.80 1.000
## 
## $F08
##       [,1] [,2] [,3]  [,4]
## [1,] 1.000 0.80 0.64 0.512
## [2,] 0.800 1.00 0.80 0.640
## [3,] 0.640 0.80 1.00 0.800
## [4,] 0.512 0.64 0.80 1.000
## 
## $F09
##       [,1] [,2] [,3]  [,4]
## [1,] 1.000 0.80 0.64 0.512
## [2,] 0.800 1.00 0.80 0.640
## [3,] 0.640 0.80 1.00 0.800
## [4,] 0.512 0.64 0.80 1.000
## 
## $F10
##       [,1] [,2] [,3]  [,4]
## [1,] 1.000 0.80 0.64 0.512
## [2,] 0.800 1.00 0.80 0.640
## [3,] 0.640 0.80 1.00 0.800
## [4,] 0.512 0.64 0.80 1.000
## 
## $F11
##       [,1] [,2] [,3]  [,4]
## [1,] 1.000 0.80 0.64 0.512
## [2,] 0.800 1.00 0.80 0.640
## [3,] 0.640 0.80 1.00 0.800
## [4,] 0.512 0.64 0.80 1.000</code></pre>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb465-1" data-line-number="1">cs1ARMA &lt;-<span class="st"> </span><span class="kw">corARMA</span>(<span class="fl">0.4</span>, <span class="dt">form =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Subject, <span class="dt">q =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb465-2" data-line-number="2">cs1ARMA &lt;-<span class="st"> </span><span class="kw">Initialize</span>(cs1ARMA, <span class="dt">data =</span> Orthodont)</a>
<a class="sourceLine" id="cb465-3" data-line-number="3"><span class="kw">corMatrix</span>(cs1ARMA)</a></code></pre></div>
<pre><code>## $M01
##         [,1]    [,2]    [,3]    [,4]
## [1,] 1.00000 0.34483 0.00000 0.00000
## [2,] 0.34483 1.00000 0.34483 0.00000
## [3,] 0.00000 0.34483 1.00000 0.34483
## [4,] 0.00000 0.00000 0.34483 1.00000
## 
## $M02
##         [,1]    [,2]    [,3]    [,4]
## [1,] 1.00000 0.34483 0.00000 0.00000
## [2,] 0.34483 1.00000 0.34483 0.00000
## [3,] 0.00000 0.34483 1.00000 0.34483
## [4,] 0.00000 0.00000 0.34483 1.00000
## 
## $M03
##         [,1]    [,2]    [,3]    [,4]
## [1,] 1.00000 0.34483 0.00000 0.00000
## [2,] 0.34483 1.00000 0.34483 0.00000
## [3,] 0.00000 0.34483 1.00000 0.34483
## [4,] 0.00000 0.00000 0.34483 1.00000
## 
## $M04
##         [,1]    [,2]    [,3]    [,4]
## [1,] 1.00000 0.34483 0.00000 0.00000
## [2,] 0.34483 1.00000 0.34483 0.00000
## [3,] 0.00000 0.34483 1.00000 0.34483
## [4,] 0.00000 0.00000 0.34483 1.00000
## 
## $M05
##         [,1]    [,2]    [,3]    [,4]
## [1,] 1.00000 0.34483 0.00000 0.00000
## [2,] 0.34483 1.00000 0.34483 0.00000
## [3,] 0.00000 0.34483 1.00000 0.34483
## [4,] 0.00000 0.00000 0.34483 1.00000
## 
## $M06
##         [,1]    [,2]    [,3]    [,4]
## [1,] 1.00000 0.34483 0.00000 0.00000
## [2,] 0.34483 1.00000 0.34483 0.00000
## [3,] 0.00000 0.34483 1.00000 0.34483
## [4,] 0.00000 0.00000 0.34483 1.00000
## 
## $M07
##         [,1]    [,2]    [,3]    [,4]
## [1,] 1.00000 0.34483 0.00000 0.00000
## [2,] 0.34483 1.00000 0.34483 0.00000
## [3,] 0.00000 0.34483 1.00000 0.34483
## [4,] 0.00000 0.00000 0.34483 1.00000
## 
## $M08
##         [,1]    [,2]    [,3]    [,4]
## [1,] 1.00000 0.34483 0.00000 0.00000
## [2,] 0.34483 1.00000 0.34483 0.00000
## [3,] 0.00000 0.34483 1.00000 0.34483
## [4,] 0.00000 0.00000 0.34483 1.00000
## 
## $M09
##         [,1]    [,2]    [,3]    [,4]
## [1,] 1.00000 0.34483 0.00000 0.00000
## [2,] 0.34483 1.00000 0.34483 0.00000
## [3,] 0.00000 0.34483 1.00000 0.34483
## [4,] 0.00000 0.00000 0.34483 1.00000
## 
## $M10
##         [,1]    [,2]    [,3]    [,4]
## [1,] 1.00000 0.34483 0.00000 0.00000
## [2,] 0.34483 1.00000 0.34483 0.00000
## [3,] 0.00000 0.34483 1.00000 0.34483
## [4,] 0.00000 0.00000 0.34483 1.00000
## 
## $M11
##         [,1]    [,2]    [,3]    [,4]
## [1,] 1.00000 0.34483 0.00000 0.00000
## [2,] 0.34483 1.00000 0.34483 0.00000
## [3,] 0.00000 0.34483 1.00000 0.34483
## [4,] 0.00000 0.00000 0.34483 1.00000
## 
## $M12
##         [,1]    [,2]    [,3]    [,4]
## [1,] 1.00000 0.34483 0.00000 0.00000
## [2,] 0.34483 1.00000 0.34483 0.00000
## [3,] 0.00000 0.34483 1.00000 0.34483
## [4,] 0.00000 0.00000 0.34483 1.00000
## 
## $M13
##         [,1]    [,2]    [,3]    [,4]
## [1,] 1.00000 0.34483 0.00000 0.00000
## [2,] 0.34483 1.00000 0.34483 0.00000
## [3,] 0.00000 0.34483 1.00000 0.34483
## [4,] 0.00000 0.00000 0.34483 1.00000
## 
## $M14
##         [,1]    [,2]    [,3]    [,4]
## [1,] 1.00000 0.34483 0.00000 0.00000
## [2,] 0.34483 1.00000 0.34483 0.00000
## [3,] 0.00000 0.34483 1.00000 0.34483
## [4,] 0.00000 0.00000 0.34483 1.00000
## 
## $M15
##         [,1]    [,2]    [,3]    [,4]
## [1,] 1.00000 0.34483 0.00000 0.00000
## [2,] 0.34483 1.00000 0.34483 0.00000
## [3,] 0.00000 0.34483 1.00000 0.34483
## [4,] 0.00000 0.00000 0.34483 1.00000
## 
## $M16
##         [,1]    [,2]    [,3]    [,4]
## [1,] 1.00000 0.34483 0.00000 0.00000
## [2,] 0.34483 1.00000 0.34483 0.00000
## [3,] 0.00000 0.34483 1.00000 0.34483
## [4,] 0.00000 0.00000 0.34483 1.00000
## 
## $F01
##         [,1]    [,2]    [,3]    [,4]
## [1,] 1.00000 0.34483 0.00000 0.00000
## [2,] 0.34483 1.00000 0.34483 0.00000
## [3,] 0.00000 0.34483 1.00000 0.34483
## [4,] 0.00000 0.00000 0.34483 1.00000
## 
## $F02
##         [,1]    [,2]    [,3]    [,4]
## [1,] 1.00000 0.34483 0.00000 0.00000
## [2,] 0.34483 1.00000 0.34483 0.00000
## [3,] 0.00000 0.34483 1.00000 0.34483
## [4,] 0.00000 0.00000 0.34483 1.00000
## 
## $F03
##         [,1]    [,2]    [,3]    [,4]
## [1,] 1.00000 0.34483 0.00000 0.00000
## [2,] 0.34483 1.00000 0.34483 0.00000
## [3,] 0.00000 0.34483 1.00000 0.34483
## [4,] 0.00000 0.00000 0.34483 1.00000
## 
## $F04
##         [,1]    [,2]    [,3]    [,4]
## [1,] 1.00000 0.34483 0.00000 0.00000
## [2,] 0.34483 1.00000 0.34483 0.00000
## [3,] 0.00000 0.34483 1.00000 0.34483
## [4,] 0.00000 0.00000 0.34483 1.00000
## 
## $F05
##         [,1]    [,2]    [,3]    [,4]
## [1,] 1.00000 0.34483 0.00000 0.00000
## [2,] 0.34483 1.00000 0.34483 0.00000
## [3,] 0.00000 0.34483 1.00000 0.34483
## [4,] 0.00000 0.00000 0.34483 1.00000
## 
## $F06
##         [,1]    [,2]    [,3]    [,4]
## [1,] 1.00000 0.34483 0.00000 0.00000
## [2,] 0.34483 1.00000 0.34483 0.00000
## [3,] 0.00000 0.34483 1.00000 0.34483
## [4,] 0.00000 0.00000 0.34483 1.00000
## 
## $F07
##         [,1]    [,2]    [,3]    [,4]
## [1,] 1.00000 0.34483 0.00000 0.00000
## [2,] 0.34483 1.00000 0.34483 0.00000
## [3,] 0.00000 0.34483 1.00000 0.34483
## [4,] 0.00000 0.00000 0.34483 1.00000
## 
## $F08
##         [,1]    [,2]    [,3]    [,4]
## [1,] 1.00000 0.34483 0.00000 0.00000
## [2,] 0.34483 1.00000 0.34483 0.00000
## [3,] 0.00000 0.34483 1.00000 0.34483
## [4,] 0.00000 0.00000 0.34483 1.00000
## 
## $F09
##         [,1]    [,2]    [,3]    [,4]
## [1,] 1.00000 0.34483 0.00000 0.00000
## [2,] 0.34483 1.00000 0.34483 0.00000
## [3,] 0.00000 0.34483 1.00000 0.34483
## [4,] 0.00000 0.00000 0.34483 1.00000
## 
## $F10
##         [,1]    [,2]    [,3]    [,4]
## [1,] 1.00000 0.34483 0.00000 0.00000
## [2,] 0.34483 1.00000 0.34483 0.00000
## [3,] 0.00000 0.34483 1.00000 0.34483
## [4,] 0.00000 0.00000 0.34483 1.00000
## 
## $F11
##         [,1]    [,2]    [,3]    [,4]
## [1,] 1.00000 0.34483 0.00000 0.00000
## [2,] 0.34483 1.00000 0.34483 0.00000
## [3,] 0.00000 0.34483 1.00000 0.34483
## [4,] 0.00000 0.00000 0.34483 1.00000</code></pre>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb467-1" data-line-number="1">cs2ARMA &lt;-<span class="st"> </span><span class="kw">corARMA</span>(<span class="kw">c</span>(<span class="fl">0.8</span>, <span class="fl">0.4</span>), <span class="dt">form =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Subject, <span class="dt">p=</span><span class="dv">1</span>, <span class="dt">q=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb467-2" data-line-number="2">cs2ARMA &lt;-<span class="st"> </span><span class="kw">Initialize</span>(cs2ARMA, <span class="dt">data =</span> Orthodont)</a>
<a class="sourceLine" id="cb467-3" data-line-number="3"><span class="kw">corMatrix</span>(cs2ARMA)</a></code></pre></div>
<pre><code>## $M01
##        [,1]  [,2]  [,3]   [,4]
## [1,] 1.0000 0.880 0.704 0.5632
## [2,] 0.8800 1.000 0.880 0.7040
## [3,] 0.7040 0.880 1.000 0.8800
## [4,] 0.5632 0.704 0.880 1.0000
## 
## $M02
##        [,1]  [,2]  [,3]   [,4]
## [1,] 1.0000 0.880 0.704 0.5632
## [2,] 0.8800 1.000 0.880 0.7040
## [3,] 0.7040 0.880 1.000 0.8800
## [4,] 0.5632 0.704 0.880 1.0000
## 
## $M03
##        [,1]  [,2]  [,3]   [,4]
## [1,] 1.0000 0.880 0.704 0.5632
## [2,] 0.8800 1.000 0.880 0.7040
## [3,] 0.7040 0.880 1.000 0.8800
## [4,] 0.5632 0.704 0.880 1.0000
## 
## $M04
##        [,1]  [,2]  [,3]   [,4]
## [1,] 1.0000 0.880 0.704 0.5632
## [2,] 0.8800 1.000 0.880 0.7040
## [3,] 0.7040 0.880 1.000 0.8800
## [4,] 0.5632 0.704 0.880 1.0000
## 
## $M05
##        [,1]  [,2]  [,3]   [,4]
## [1,] 1.0000 0.880 0.704 0.5632
## [2,] 0.8800 1.000 0.880 0.7040
## [3,] 0.7040 0.880 1.000 0.8800
## [4,] 0.5632 0.704 0.880 1.0000
## 
## $M06
##        [,1]  [,2]  [,3]   [,4]
## [1,] 1.0000 0.880 0.704 0.5632
## [2,] 0.8800 1.000 0.880 0.7040
## [3,] 0.7040 0.880 1.000 0.8800
## [4,] 0.5632 0.704 0.880 1.0000
## 
## $M07
##        [,1]  [,2]  [,3]   [,4]
## [1,] 1.0000 0.880 0.704 0.5632
## [2,] 0.8800 1.000 0.880 0.7040
## [3,] 0.7040 0.880 1.000 0.8800
## [4,] 0.5632 0.704 0.880 1.0000
## 
## $M08
##        [,1]  [,2]  [,3]   [,4]
## [1,] 1.0000 0.880 0.704 0.5632
## [2,] 0.8800 1.000 0.880 0.7040
## [3,] 0.7040 0.880 1.000 0.8800
## [4,] 0.5632 0.704 0.880 1.0000
## 
## $M09
##        [,1]  [,2]  [,3]   [,4]
## [1,] 1.0000 0.880 0.704 0.5632
## [2,] 0.8800 1.000 0.880 0.7040
## [3,] 0.7040 0.880 1.000 0.8800
## [4,] 0.5632 0.704 0.880 1.0000
## 
## $M10
##        [,1]  [,2]  [,3]   [,4]
## [1,] 1.0000 0.880 0.704 0.5632
## [2,] 0.8800 1.000 0.880 0.7040
## [3,] 0.7040 0.880 1.000 0.8800
## [4,] 0.5632 0.704 0.880 1.0000
## 
## $M11
##        [,1]  [,2]  [,3]   [,4]
## [1,] 1.0000 0.880 0.704 0.5632
## [2,] 0.8800 1.000 0.880 0.7040
## [3,] 0.7040 0.880 1.000 0.8800
## [4,] 0.5632 0.704 0.880 1.0000
## 
## $M12
##        [,1]  [,2]  [,3]   [,4]
## [1,] 1.0000 0.880 0.704 0.5632
## [2,] 0.8800 1.000 0.880 0.7040
## [3,] 0.7040 0.880 1.000 0.8800
## [4,] 0.5632 0.704 0.880 1.0000
## 
## $M13
##        [,1]  [,2]  [,3]   [,4]
## [1,] 1.0000 0.880 0.704 0.5632
## [2,] 0.8800 1.000 0.880 0.7040
## [3,] 0.7040 0.880 1.000 0.8800
## [4,] 0.5632 0.704 0.880 1.0000
## 
## $M14
##        [,1]  [,2]  [,3]   [,4]
## [1,] 1.0000 0.880 0.704 0.5632
## [2,] 0.8800 1.000 0.880 0.7040
## [3,] 0.7040 0.880 1.000 0.8800
## [4,] 0.5632 0.704 0.880 1.0000
## 
## $M15
##        [,1]  [,2]  [,3]   [,4]
## [1,] 1.0000 0.880 0.704 0.5632
## [2,] 0.8800 1.000 0.880 0.7040
## [3,] 0.7040 0.880 1.000 0.8800
## [4,] 0.5632 0.704 0.880 1.0000
## 
## $M16
##        [,1]  [,2]  [,3]   [,4]
## [1,] 1.0000 0.880 0.704 0.5632
## [2,] 0.8800 1.000 0.880 0.7040
## [3,] 0.7040 0.880 1.000 0.8800
## [4,] 0.5632 0.704 0.880 1.0000
## 
## $F01
##        [,1]  [,2]  [,3]   [,4]
## [1,] 1.0000 0.880 0.704 0.5632
## [2,] 0.8800 1.000 0.880 0.7040
## [3,] 0.7040 0.880 1.000 0.8800
## [4,] 0.5632 0.704 0.880 1.0000
## 
## $F02
##        [,1]  [,2]  [,3]   [,4]
## [1,] 1.0000 0.880 0.704 0.5632
## [2,] 0.8800 1.000 0.880 0.7040
## [3,] 0.7040 0.880 1.000 0.8800
## [4,] 0.5632 0.704 0.880 1.0000
## 
## $F03
##        [,1]  [,2]  [,3]   [,4]
## [1,] 1.0000 0.880 0.704 0.5632
## [2,] 0.8800 1.000 0.880 0.7040
## [3,] 0.7040 0.880 1.000 0.8800
## [4,] 0.5632 0.704 0.880 1.0000
## 
## $F04
##        [,1]  [,2]  [,3]   [,4]
## [1,] 1.0000 0.880 0.704 0.5632
## [2,] 0.8800 1.000 0.880 0.7040
## [3,] 0.7040 0.880 1.000 0.8800
## [4,] 0.5632 0.704 0.880 1.0000
## 
## $F05
##        [,1]  [,2]  [,3]   [,4]
## [1,] 1.0000 0.880 0.704 0.5632
## [2,] 0.8800 1.000 0.880 0.7040
## [3,] 0.7040 0.880 1.000 0.8800
## [4,] 0.5632 0.704 0.880 1.0000
## 
## $F06
##        [,1]  [,2]  [,3]   [,4]
## [1,] 1.0000 0.880 0.704 0.5632
## [2,] 0.8800 1.000 0.880 0.7040
## [3,] 0.7040 0.880 1.000 0.8800
## [4,] 0.5632 0.704 0.880 1.0000
## 
## $F07
##        [,1]  [,2]  [,3]   [,4]
## [1,] 1.0000 0.880 0.704 0.5632
## [2,] 0.8800 1.000 0.880 0.7040
## [3,] 0.7040 0.880 1.000 0.8800
## [4,] 0.5632 0.704 0.880 1.0000
## 
## $F08
##        [,1]  [,2]  [,3]   [,4]
## [1,] 1.0000 0.880 0.704 0.5632
## [2,] 0.8800 1.000 0.880 0.7040
## [3,] 0.7040 0.880 1.000 0.8800
## [4,] 0.5632 0.704 0.880 1.0000
## 
## $F09
##        [,1]  [,2]  [,3]   [,4]
## [1,] 1.0000 0.880 0.704 0.5632
## [2,] 0.8800 1.000 0.880 0.7040
## [3,] 0.7040 0.880 1.000 0.8800
## [4,] 0.5632 0.704 0.880 1.0000
## 
## $F10
##        [,1]  [,2]  [,3]   [,4]
## [1,] 1.0000 0.880 0.704 0.5632
## [2,] 0.8800 1.000 0.880 0.7040
## [3,] 0.7040 0.880 1.000 0.8800
## [4,] 0.5632 0.704 0.880 1.0000
## 
## $F11
##        [,1]  [,2]  [,3]   [,4]
## [1,] 1.0000 0.880 0.704 0.5632
## [2,] 0.8800 1.000 0.880 0.7040
## [3,] 0.7040 0.880 1.000 0.8800
## [4,] 0.5632 0.704 0.880 1.0000</code></pre>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb469-1" data-line-number="1">spatDat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> (<span class="dv">0</span><span class="op">:</span><span class="dv">4</span>)<span class="op">/</span><span class="dv">4</span>, <span class="dt">y =</span> (<span class="dv">0</span><span class="op">:</span><span class="dv">4</span>)<span class="op">/</span><span class="dv">4</span>)</a>
<a class="sourceLine" id="cb469-2" data-line-number="2">cs1Exp &lt;-<span class="st"> </span><span class="kw">corExp</span>(<span class="dv">1</span>, <span class="dt">form =</span> <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>y)</a>
<a class="sourceLine" id="cb469-3" data-line-number="3">cs1Exp &lt;-<span class="st"> </span><span class="kw">Initialize</span>(cs1Exp, spatDat)</a>
<a class="sourceLine" id="cb469-4" data-line-number="4"><span class="kw">corMatrix</span>(cs1Exp)</a></code></pre></div>
<pre><code>##         [,1]    [,2]    [,3]    [,4]    [,5]
## [1,] 1.00000 0.70219 0.49307 0.34623 0.24312
## [2,] 0.70219 1.00000 0.70219 0.49307 0.34623
## [3,] 0.49307 0.70219 1.00000 0.70219 0.49307
## [4,] 0.34623 0.49307 0.70219 1.00000 0.70219
## [5,] 0.24312 0.34623 0.49307 0.70219 1.00000</code></pre>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb471-1" data-line-number="1">cs2Exp &lt;-<span class="st"> </span><span class="kw">corExp</span>(<span class="dv">1</span>, <span class="dt">form =</span> <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>y, <span class="dt">metric =</span> <span class="st">&quot;man&quot;</span>)</a>
<a class="sourceLine" id="cb471-2" data-line-number="2">cs2Exp &lt;-<span class="st"> </span><span class="kw">Initialize</span>(cs2Exp, spatDat)</a>
<a class="sourceLine" id="cb471-3" data-line-number="3"><span class="kw">corMatrix</span>(cs2Exp)</a></code></pre></div>
<pre><code>##         [,1]    [,2]    [,3]    [,4]    [,5]
## [1,] 1.00000 0.60653 0.36788 0.22313 0.13534
## [2,] 0.60653 1.00000 0.60653 0.36788 0.22313
## [3,] 0.36788 0.60653 1.00000 0.60653 0.36788
## [4,] 0.22313 0.36788 0.60653 1.00000 0.60653
## [5,] 0.13534 0.22313 0.36788 0.60653 1.00000</code></pre>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb473-1" data-line-number="1">cs3Exp &lt;-<span class="st"> </span><span class="kw">corExp</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">0.2</span>), <span class="dt">form =</span> <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>y, <span class="dt">nugget =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb473-2" data-line-number="2">cs3Exp &lt;-<span class="st"> </span><span class="kw">Initialize</span>(cs3Exp, spatDat)</a>
<a class="sourceLine" id="cb473-3" data-line-number="3"><span class="kw">corMatrix</span>(cs3Exp)</a></code></pre></div>
<pre><code>##         [,1]    [,2]    [,3]    [,4]    [,5]
## [1,] 1.00000 0.56175 0.39445 0.27698 0.19449
## [2,] 0.56175 1.00000 0.56175 0.39445 0.27698
## [3,] 0.39445 0.56175 1.00000 0.56175 0.39445
## [4,] 0.27698 0.39445 0.56175 1.00000 0.56175
## [5,] 0.19449 0.27698 0.39445 0.56175 1.00000</code></pre>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb475-1" data-line-number="1">fm1Ovar.lme &lt;-<span class="st"> </span><span class="kw">lme</span>(follicles <span class="op">~</span><span class="st"> </span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>Time) <span class="op">+</span><span class="st"> </span><span class="kw">cos</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>Time),</a>
<a class="sourceLine" id="cb475-2" data-line-number="2">                   <span class="dt">data =</span> Ovary, <span class="dt">random =</span> <span class="kw">pdDiag</span>(<span class="op">~</span><span class="kw">sin</span>(<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>Time)))</a>
<a class="sourceLine" id="cb475-3" data-line-number="3">fm1Ovar.lme</a></code></pre></div>
<pre><code>## Linear mixed-effects model fit by REML
##   Data: Ovary 
##   Log-restricted-likelihood: -813.04
##   Fixed: follicles ~ sin(2 * pi * Time) + cos(2 * pi * Time) 
##        (Intercept) sin(2 * pi * Time) cos(2 * pi * Time) 
##           12.18202           -3.29854           -0.86237 
## 
## Random effects:
##  Formula: ~sin(2 * pi * Time) | Mare
##  Structure: Diagonal
##         (Intercept) sin(2 * pi * Time) Residual
## StdDev:      3.0521             2.0793   3.1129
## 
## Number of Observations: 308
## Number of Groups: 11</code></pre>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb477-1" data-line-number="1"><span class="kw">ACF</span>(fm1Ovar.lme)</a></code></pre></div>
<pre><code>##    lag       ACF
## 1    0  1.000000
## 2    1  0.379480
## 3    2  0.179722
## 4    3  0.035693
## 5    4  0.059779
## 6    5  0.002097
## 7    6  0.064327
## 8    7  0.071635
## 9    8  0.048578
## 10   9  0.027782
## 11  10 -0.034276
## 12  11 -0.077204
## 13  12 -0.161132
## 14  13 -0.196030
## 15  14 -0.289337</code></pre>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb479-1" data-line-number="1"><span class="kw">plot</span>(<span class="kw">ACF</span>(fm1Ovar.lme,  <span class="dt">maxLag =</span> <span class="dv">10</span>), <span class="dt">alpha =</span> <span class="fl">0.01</span>)</a></code></pre></div>
<p><img src="assets/unnamed-chunk-5-5.png" width="672" /></p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb480-1" data-line-number="1">fm2Ovar.lme &lt;-<span class="st"> </span><span class="kw">update</span>(fm1Ovar.lme, <span class="dt">correlation =</span> <span class="kw">corAR1</span>())</a>
<a class="sourceLine" id="cb480-2" data-line-number="2"><span class="kw">anova</span>(fm1Ovar.lme, fm2Ovar.lme)</a></code></pre></div>
<pre><code>##             Model df    AIC    BIC  logLik   Test L.Ratio
## fm1Ovar.lme     1  6 1638.1 1660.4 -813.04               
## fm2Ovar.lme     2  7 1563.5 1589.5 -774.72 1 vs 2  76.634
##             p-value
## fm1Ovar.lme        
## fm2Ovar.lme  &lt;.0001</code></pre>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb482-1" data-line-number="1"><span class="cf">if</span> (<span class="kw">interactive</span>()) <span class="kw">intervals</span>(fm2Ovar.lme)</a>
<a class="sourceLine" id="cb482-2" data-line-number="2">fm3Ovar.lme &lt;-<span class="st"> </span><span class="kw">update</span>(fm1Ovar.lme, <span class="dt">correlation =</span> <span class="kw">corARMA</span>(<span class="dt">q =</span> <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb482-3" data-line-number="3">fm3Ovar.lme</a></code></pre></div>
<pre><code>## Linear mixed-effects model fit by REML
##   Data: Ovary 
##   Log-restricted-likelihood: -777.62
##   Fixed: follicles ~ sin(2 * pi * Time) + cos(2 * pi * Time) 
##        (Intercept) sin(2 * pi * Time) cos(2 * pi * Time) 
##           12.19419           -3.11453           -0.86911 
## 
## Random effects:
##  Formula: ~sin(2 * pi * Time) | Mare
##  Structure: Diagonal
##         (Intercept) sin(2 * pi * Time) Residual
## StdDev:      2.9741             1.6732   3.2442
## 
## Correlation Structure: ARMA(0,2)
##  Formula: ~1 | Mare 
##  Parameter estimate(s):
##  Theta1  Theta2 
## 0.47524 0.25701 
## Number of Observations: 308
## Number of Groups: 11</code></pre>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb484-1" data-line-number="1"><span class="kw">anova</span>(fm2Ovar.lme, fm3Ovar.lme, <span class="dt">test =</span> F)</a></code></pre></div>
<pre><code>##             Model df    AIC    BIC  logLik
## fm2Ovar.lme     1  7 1563.5 1589.5 -774.72
## fm3Ovar.lme     2  8 1571.2 1601.0 -777.62</code></pre>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb486-1" data-line-number="1">fm4Ovar.lme &lt;-<span class="st"> </span><span class="kw">update</span>(fm1Ovar.lme,</a>
<a class="sourceLine" id="cb486-2" data-line-number="2">                       <span class="dt">correlation =</span> <span class="kw">corCAR1</span>(<span class="dt">form =</span> <span class="op">~</span>Time))</a>
<a class="sourceLine" id="cb486-3" data-line-number="3"><span class="kw">anova</span>(fm2Ovar.lme, fm4Ovar.lme, <span class="dt">test =</span> F)</a></code></pre></div>
<pre><code>##             Model df    AIC    BIC  logLik
## fm2Ovar.lme     1  7 1563.5 1589.5 -774.72
## fm4Ovar.lme     2  7 1565.5 1591.6 -775.77</code></pre>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb488-1" data-line-number="1">(fm5Ovar.lme &lt;-<span class="st"> </span><span class="kw">update</span>(fm1Ovar.lme,</a>
<a class="sourceLine" id="cb488-2" data-line-number="2">                       <span class="dt">corr =</span> <span class="kw">corARMA</span>(<span class="dt">p =</span> <span class="dv">1</span>, <span class="dt">q =</span> <span class="dv">1</span>)))</a></code></pre></div>
<pre><code>## Linear mixed-effects model fit by REML
##   Data: Ovary 
##   Log-restricted-likelihood: -771.95
##   Fixed: follicles ~ sin(2 * pi * Time) + cos(2 * pi * Time) 
##        (Intercept) sin(2 * pi * Time) cos(2 * pi * Time) 
##           12.12487           -2.91983           -0.84871 
## 
## Random effects:
##  Formula: ~sin(2 * pi * Time) | Mare
##  Structure: Diagonal
##         (Intercept) sin(2 * pi * Time) Residual
## StdDev:      2.6144             1.0049   3.7334
## 
## Correlation Structure: ARMA(1,1)
##  Formula: ~1 | Mare 
##  Parameter estimate(s):
##     Phi1   Theta1 
##  0.78689 -0.27936 
## Number of Observations: 308
## Number of Groups: 11</code></pre>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb490-1" data-line-number="1"><span class="kw">anova</span>(fm2Ovar.lme, fm5Ovar.lme)</a></code></pre></div>
<pre><code>##             Model df    AIC    BIC  logLik   Test L.Ratio
## fm2Ovar.lme     1  7 1563.5 1589.5 -774.72               
## fm5Ovar.lme     2  8 1559.9 1589.7 -771.95 1 vs 2  5.5538
##             p-value
## fm2Ovar.lme        
## fm5Ovar.lme  0.0184</code></pre>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb492-1" data-line-number="1"><span class="kw">plot</span>(<span class="kw">ACF</span>(fm5Ovar.lme,  <span class="dt">maxLag =</span> <span class="dv">10</span>, <span class="dt">resType =</span> <span class="st">&quot;n&quot;</span>), <span class="dt">alpha =</span> <span class="fl">0.01</span>)</a></code></pre></div>
<p><img src="assets/unnamed-chunk-5-6.png" width="672" /></p>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb493-1" data-line-number="1"><span class="kw">Variogram</span>(fm2BW.lme, <span class="dt">form =</span> <span class="op">~</span><span class="st"> </span>Time)</a></code></pre></div>
<pre><code>##     variog dist n.pairs
## 1  0.34506    1      16
## 2  0.99326    6      16
## 3  0.76201    7     144
## 4  0.68493    8      16
## 5  0.68184   13      16
## 6  0.95119   14     128
## 7  0.89961   15      16
## 8  1.69441   20      16
## 9  1.12511   21     112
## 10 1.08828   22      16
## 11 0.89696   28      96
## 12 0.93233   29      16
## 13 0.85146   35      80
## 14 0.75460   36      16
## 15 1.08217   42      64
## 16 1.56669   43      16
## 17 0.64376   49      48
## 18 0.67355   56      32
## 19 0.58680   63      16</code></pre>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb495-1" data-line-number="1"><span class="kw">plot</span>(<span class="kw">Variogram</span>(fm2BW.lme, <span class="dt">form =</span> <span class="op">~</span><span class="st"> </span>Time, <span class="dt">maxDist =</span> <span class="dv">42</span>))</a></code></pre></div>
<p><img src="assets/unnamed-chunk-5-7.png" width="672" /></p>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb496-1" data-line-number="1">fm3BW.lme &lt;-<span class="st"> </span><span class="kw">update</span>(fm2BW.lme,</a>
<a class="sourceLine" id="cb496-2" data-line-number="2">                    <span class="dt">correlation =</span> <span class="kw">corExp</span>(<span class="dt">form =</span> <span class="op">~</span><span class="st"> </span>Time))</a>
<a class="sourceLine" id="cb496-3" data-line-number="3"><span class="kw">intervals</span>(fm3BW.lme)</a></code></pre></div>
<pre><code>## Approximate 95% confidence intervals
## 
##  Fixed effects:
##                  lower      est.     upper
## (Intercept) 225.637859 251.48677 277.33568
## Time          0.192914   0.36259   0.53226
## Diet2       151.729596 200.78555 249.84150
## Diet3       203.512665 252.58990 301.66713
## Time:Diet2    0.321775   0.62402   0.92627
## Time:Diet3    0.002626   0.30656   0.61050
## attr(,&quot;label&quot;)
## [1] &quot;Fixed effects:&quot;
## 
##  Random Effects:
##   Level: Rat 
##                          lower     est.    upper
## sd((Intercept))       25.02845 36.91913 54.45891
## sd(Time)               0.14747  0.23281  0.36756
## cor((Intercept),Time) -0.62699 -0.14661  0.41455
## 
##  Correlation structure:
##        lower   est.  upper
## range 2.4616 4.8864 9.6996
## attr(,&quot;label&quot;)
## [1] &quot;Correlation structure:&quot;
## 
##  Variance function:
##         lower    est.   upper
## power 0.24463 0.59434 0.94405
## attr(,&quot;label&quot;)
## [1] &quot;Variance function:&quot;
## 
##  Within-group standard error:
##    lower     est.    upper 
## 0.018105 0.138387 1.057789</code></pre>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb498-1" data-line-number="1"><span class="kw">anova</span>(fm2BW.lme, fm3BW.lme)</a></code></pre></div>
<pre><code>##           Model df    AIC    BIC  logLik   Test L.Ratio p-value
## fm2BW.lme     1 11 1163.9 1198.4 -570.96                       
## fm3BW.lme     2 12 1145.1 1182.8 -560.57 1 vs 2  20.781  &lt;.0001</code></pre>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb500-1" data-line-number="1">fm4BW.lme &lt;-</a>
<a class="sourceLine" id="cb500-2" data-line-number="2"><span class="st">      </span><span class="kw">update</span>(fm3BW.lme, <span class="dt">correlation =</span> <span class="kw">corExp</span>(<span class="dt">form =</span>  <span class="op">~</span><span class="st"> </span>Time,</a>
<a class="sourceLine" id="cb500-3" data-line-number="3">                        <span class="dt">nugget =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb500-4" data-line-number="4"><span class="kw">anova</span>(fm3BW.lme, fm4BW.lme)</a></code></pre></div>
<pre><code>##           Model df    AIC    BIC  logLik   Test L.Ratio p-value
## fm3BW.lme     1 12 1145.1 1182.8 -560.57                       
## fm4BW.lme     2 13 1137.6 1178.4 -555.82 1 vs 2  9.5025  0.0021</code></pre>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb502-1" data-line-number="1"><span class="kw">plot</span>(<span class="kw">Variogram</span>(fm3BW.lme, <span class="dt">form =</span> <span class="op">~</span><span class="st"> </span>Time, <span class="dt">maxDist =</span> <span class="dv">42</span>))</a></code></pre></div>
<p><img src="assets/unnamed-chunk-5-8.png" width="672" /></p>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb503-1" data-line-number="1"><span class="kw">plot</span>(<span class="kw">Variogram</span>(fm3BW.lme, <span class="dt">form =</span> <span class="op">~</span><span class="st"> </span>Time, <span class="dt">maxDist =</span> <span class="dv">42</span>,</a>
<a class="sourceLine" id="cb503-2" data-line-number="2">               <span class="dt">resType =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">robust =</span> <span class="ot">TRUE</span>))</a></code></pre></div>
<p><img src="assets/unnamed-chunk-5-9.png" width="672" /></p>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb504-1" data-line-number="1">fm5BW.lme &lt;-<span class="st"> </span><span class="kw">update</span>(fm3BW.lme, <span class="dt">correlation =</span> <span class="kw">corRatio</span>(<span class="dt">form =</span> <span class="op">~</span><span class="st"> </span>Time))</a>
<a class="sourceLine" id="cb504-2" data-line-number="2">fm6BW.lme &lt;-<span class="st"> </span><span class="kw">update</span>(fm3BW.lme, <span class="dt">correlation =</span> <span class="kw">corSpher</span>(<span class="dt">form =</span> <span class="op">~</span><span class="st"> </span>Time))</a>
<a class="sourceLine" id="cb504-3" data-line-number="3">fm7BW.lme &lt;-<span class="st"> </span><span class="kw">update</span>(fm3BW.lme, <span class="dt">correlation =</span> <span class="kw">corLin</span>(<span class="dt">form =</span> <span class="op">~</span><span class="st"> </span>Time))</a>
<a class="sourceLine" id="cb504-4" data-line-number="4">fm8BW.lme &lt;-<span class="st"> </span><span class="kw">update</span>(fm3BW.lme, <span class="dt">correlation =</span> <span class="kw">corGaus</span>(<span class="dt">form =</span> <span class="op">~</span><span class="st"> </span>Time))</a>
<a class="sourceLine" id="cb504-5" data-line-number="5"><span class="kw">anova</span>(fm3BW.lme, fm5BW.lme, fm6BW.lme, fm7BW.lme, fm8BW.lme)</a></code></pre></div>
<pre><code>##           Model df    AIC    BIC  logLik
## fm3BW.lme     1 12 1145.1 1182.8 -560.57
## fm5BW.lme     2 12 1148.8 1186.4 -562.38
## fm6BW.lme     3 12 1150.8 1188.4 -563.39
## fm7BW.lme     4 12 1150.8 1188.4 -563.39
## fm8BW.lme     5 12 1150.8 1188.4 -563.39</code></pre>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb506-1" data-line-number="1">fm1Orth.gls &lt;-<span class="st"> </span><span class="kw">gls</span>(distance <span class="op">~</span><span class="st"> </span>Sex <span class="op">*</span><span class="st"> </span><span class="kw">I</span>(age <span class="op">-</span><span class="st"> </span><span class="dv">11</span>), Orthodont,</a>
<a class="sourceLine" id="cb506-2" data-line-number="2">                   <span class="dt">correlation =</span> <span class="kw">corSymm</span>(<span class="dt">form =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Subject),</a>
<a class="sourceLine" id="cb506-3" data-line-number="3">                   <span class="dt">weights =</span> <span class="kw">varIdent</span>(<span class="dt">form =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>age))</a>
<a class="sourceLine" id="cb506-4" data-line-number="4">fm1Orth.gls</a></code></pre></div>
<pre><code>## Generalized least squares fit by REML
##   Model: distance ~ Sex * I(age - 11) 
##   Data: Orthodont 
##   Log-restricted-likelihood: -212.27
## 
## Coefficients:
##           (Intercept)             SexFemale 
##              24.93712              -2.27174 
##           I(age - 11) SexFemale:I(age - 11) 
##               0.82680              -0.35044 
## 
## Correlation Structure: General
##  Formula: ~1 | Subject 
##  Parameter estimate(s):
##  Correlation: 
##   1     2     3    
## 2 0.568            
## 3 0.659 0.581      
## 4 0.522 0.725 0.740
## Variance function:
##  Structure: Different standard deviations per stratum
##  Formula: ~1 | age 
##  Parameter estimates:
##       8      10      12      14 
## 1.00000 0.87888 1.07446 0.95869 
## Degrees of freedom: 108 total; 104 residual
## Residual standard error: 2.3292</code></pre>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb508-1" data-line-number="1"><span class="kw">intervals</span>(fm1Orth.gls)</a></code></pre></div>
<pre><code>## Approximate 95% confidence intervals
## 
##  Coefficients:
##                          lower     est.     upper
## (Intercept)           23.99941 24.93712 25.874835
## SexFemale             -3.74086 -2.27174 -0.802630
## I(age - 11)            0.66376  0.82680  0.989845
## SexFemale:I(age - 11) -0.60587 -0.35044 -0.095003
## attr(,&quot;label&quot;)
## [1] &quot;Coefficients:&quot;
## 
##  Correlation structure:
##            lower    est.   upper
## cor(1,2) 0.25295 0.56820 0.77437
## cor(1,3) 0.38394 0.65895 0.82658
## cor(1,4) 0.18478 0.52204 0.74930
## cor(2,3) 0.27267 0.58061 0.78064
## cor(2,4) 0.48205 0.72492 0.86433
## cor(3,4) 0.51333 0.73962 0.86975
## attr(,&quot;label&quot;)
## [1] &quot;Correlation structure:&quot;
## 
##  Variance function:
##      lower    est.  upper
## 10 0.63223 0.87888 1.2217
## 12 0.79935 1.07446 1.4443
## 14 0.68137 0.95869 1.3489
## attr(,&quot;label&quot;)
## [1] &quot;Variance function:&quot;
## 
##  Residual standard error:
##  lower   est.  upper 
## 1.7597 2.3292 3.0831</code></pre>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb510-1" data-line-number="1">fm2Orth.gls &lt;-</a>
<a class="sourceLine" id="cb510-2" data-line-number="2"><span class="st">   </span><span class="kw">update</span>(fm1Orth.gls, <span class="dt">corr =</span> <span class="kw">corCompSymm</span>(<span class="dt">form =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Subject))</a>
<a class="sourceLine" id="cb510-3" data-line-number="3"><span class="kw">anova</span>(fm1Orth.gls, fm2Orth.gls)</a></code></pre></div>
<pre><code>##             Model df    AIC    BIC  logLik   Test L.Ratio
## fm1Orth.gls     1 14 452.55 489.57 -212.27               
## fm2Orth.gls     2  9 449.97 473.77 -215.99 1 vs 2  7.4256
##             p-value
## fm1Orth.gls        
## fm2Orth.gls  0.1909</code></pre>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb512-1" data-line-number="1"><span class="kw">intervals</span>(fm2Orth.gls)</a></code></pre></div>
<pre><code>## Approximate 95% confidence intervals
## 
##  Coefficients:
##                          lower     est.     upper
## (Intercept)           23.92956 24.86832 25.807077
## SexFemale             -3.66815 -2.19740 -0.726641
## I(age - 11)            0.64160  0.79431  0.947029
## SexFemale:I(age - 11) -0.55482 -0.31556 -0.076301
## attr(,&quot;label&quot;)
## [1] &quot;Coefficients:&quot;
## 
##  Correlation structure:
##       lower    est.   upper
## Rho 0.44608 0.63529 0.77825
## attr(,&quot;label&quot;)
## [1] &quot;Correlation structure:&quot;
## 
##  Variance function:
##      lower    est.  upper
## 10 0.63545 0.86236 1.1703
## 12 0.76905 1.03395 1.3901
## 14 0.67823 0.92037 1.2490
## attr(,&quot;label&quot;)
## [1] &quot;Variance function:&quot;
## 
##  Residual standard error:
##  lower   est.  upper 
## 1.8023 2.3868 3.1609</code></pre>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb514-1" data-line-number="1">fm3Orth.gls &lt;-<span class="st"> </span><span class="kw">update</span>(fm2Orth.gls, <span class="dt">weights =</span> <span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb514-2" data-line-number="2"><span class="kw">anova</span>(fm2Orth.gls, fm3Orth.gls)</a></code></pre></div>
<pre><code>##             Model df    AIC    BIC  logLik   Test L.Ratio
## fm2Orth.gls     1  9 449.97 473.77 -215.99               
## fm3Orth.gls     2  6 445.76 461.62 -216.88 1 vs 2  1.7849
##             p-value
## fm2Orth.gls        
## fm3Orth.gls  0.6182</code></pre>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb516-1" data-line-number="1"><span class="kw">plot</span>(fm3Orth.gls, <span class="kw">resid</span>(., <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>) <span class="op">~</span><span class="st"> </span>age <span class="op">|</span><span class="st"> </span>Sex)</a></code></pre></div>
<p><img src="assets/unnamed-chunk-5-10.png" width="672" /></p>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb517-1" data-line-number="1">fm4Orth.gls &lt;-<span class="st"> </span><span class="kw">update</span>(fm3Orth.gls,</a>
<a class="sourceLine" id="cb517-2" data-line-number="2">                      <span class="dt">weights =</span> <span class="kw">varIdent</span>(<span class="dt">form =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Sex))</a>
<a class="sourceLine" id="cb517-3" data-line-number="3"><span class="kw">anova</span>(fm3Orth.gls, fm4Orth.gls)</a></code></pre></div>
<pre><code>##             Model df    AIC    BIC  logLik   Test L.Ratio
## fm3Orth.gls     1  6 445.76 461.62 -216.88               
## fm4Orth.gls     2  7 436.19 454.70 -211.09 1 vs 2  11.569
##             p-value
## fm3Orth.gls        
## fm4Orth.gls   7e-04</code></pre>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb519-1" data-line-number="1"><span class="kw">qqnorm</span>(fm4Orth.gls, <span class="op">~</span><span class="kw">resid</span>(., <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>))</a></code></pre></div>
<p><img src="assets/unnamed-chunk-5-11.png" width="672" /></p>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb520-1" data-line-number="1"><span class="co"># not in book but needed for the following command</span></a>
<a class="sourceLine" id="cb520-2" data-line-number="2">fm3Orth.lme &lt;-</a>
<a class="sourceLine" id="cb520-3" data-line-number="3"><span class="st">    </span><span class="kw">lme</span>(distance<span class="op">~</span>Sex<span class="op">*</span><span class="kw">I</span>(age<span class="dv">-11</span>), <span class="dt">data =</span> Orthodont,</a>
<a class="sourceLine" id="cb520-4" data-line-number="4">        <span class="dt">random =</span> <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(age<span class="dv">-11</span>) <span class="op">|</span><span class="st"> </span>Subject,</a>
<a class="sourceLine" id="cb520-5" data-line-number="5">        <span class="dt">weights =</span> <span class="kw">varIdent</span>(<span class="dt">form =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Sex))</a>
<a class="sourceLine" id="cb520-6" data-line-number="6"><span class="kw">anova</span>(fm3Orth.lme, fm4Orth.gls, <span class="dt">test =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>##             Model df    AIC    BIC  logLik
## fm3Orth.lme     1  9 429.52 453.32 -205.76
## fm4Orth.gls     2  7 436.19 454.70 -211.09</code></pre>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb522-1" data-line-number="1">fm1Dial.gls &lt;-</a>
<a class="sourceLine" id="cb522-2" data-line-number="2"><span class="st">  </span><span class="kw">gls</span>(rate <span class="op">~</span>(pressure <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(pressure<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(pressure<span class="op">^</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(pressure<span class="op">^</span><span class="dv">4</span>))<span class="op">*</span>QB,</a>
<a class="sourceLine" id="cb522-3" data-line-number="3">      Dialyzer)</a>
<a class="sourceLine" id="cb522-4" data-line-number="4"><span class="kw">plot</span>(fm1Dial.gls, <span class="kw">resid</span>(.) <span class="op">~</span><span class="st"> </span>pressure, <span class="dt">abline =</span> <span class="dv">0</span>)</a></code></pre></div>
<p><img src="assets/unnamed-chunk-5-12.png" width="672" /></p>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb523-1" data-line-number="1">fm2Dial.gls &lt;-<span class="st"> </span><span class="kw">update</span>(fm1Dial.gls,</a>
<a class="sourceLine" id="cb523-2" data-line-number="2">                      <span class="dt">weights =</span> <span class="kw">varPower</span>(<span class="dt">form =</span> <span class="op">~</span><span class="st"> </span>pressure))</a>
<a class="sourceLine" id="cb523-3" data-line-number="3"><span class="kw">anova</span>(fm1Dial.gls, fm2Dial.gls)</a></code></pre></div>
<pre><code>##             Model df    AIC    BIC  logLik   Test L.Ratio
## fm1Dial.gls     1 11 761.17 792.71 -369.59               
## fm2Dial.gls     2 12 738.22 772.63 -357.11 1 vs 2   24.95
##             p-value
## fm1Dial.gls        
## fm2Dial.gls  &lt;.0001</code></pre>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb525-1" data-line-number="1"><span class="kw">ACF</span>(fm2Dial.gls, <span class="dt">form =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Subject)</a></code></pre></div>
<pre><code>##   lag      ACF
## 1   0 1.000000
## 2   1 0.770851
## 3   2 0.632301
## 4   3 0.408306
## 5   4 0.200737
## 6   5 0.073116
## 7   6 0.077802</code></pre>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb527-1" data-line-number="1"><span class="kw">plot</span>(<span class="kw">ACF</span>(fm2Dial.gls, <span class="dt">form =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Subject), <span class="dt">alpha =</span> <span class="fl">0.01</span>)</a></code></pre></div>
<p><img src="assets/unnamed-chunk-5-13.png" width="672" /></p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb528-1" data-line-number="1">(fm3Dial.gls &lt;-<span class="st"> </span><span class="kw">update</span>(fm2Dial.gls,</a>
<a class="sourceLine" id="cb528-2" data-line-number="2">                      <span class="dt">corr =</span> <span class="kw">corAR1</span>(<span class="fl">0.771</span>, <span class="dt">form =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Subject)))</a></code></pre></div>
<pre><code>## Generalized least squares fit by REML
##   Model: rate ~ (pressure + I(pressure^2) + I(pressure^3) + I(pressure^4)) *      QB 
##   Data: Dialyzer 
##   Log-restricted-likelihood: -308.34
## 
## Coefficients:
##         (Intercept)            pressure       I(pressure^2) 
##           -16.81845            92.33424           -49.26516 
##       I(pressure^3)       I(pressure^4)               QB300 
##            11.39968            -1.01964            -1.59419 
##      pressure:QB300 I(pressure^2):QB300 I(pressure^3):QB300 
##             1.70543             2.12680             0.47971 
## I(pressure^4):QB300 
##            -0.22064 
## 
## Correlation Structure: AR(1)
##  Formula: ~1 | Subject 
##  Parameter estimate(s):
##    Phi 
## 0.7526 
## Variance function:
##  Structure: Power of variance covariate
##  Formula: ~pressure 
##  Parameter estimates:
##   power 
## 0.51824 
## Degrees of freedom: 140 total; 130 residual
## Residual standard error: 3.0463</code></pre>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb530-1" data-line-number="1"><span class="kw">intervals</span>(fm3Dial.gls)</a></code></pre></div>
<pre><code>## Approximate 95% confidence intervals
## 
##  Coefficients:
##                        lower      est.      upper
## (Intercept)         -18.8968 -16.81845 -14.740093
## pressure             81.9144  92.33424 102.754095
## I(pressure^2)       -63.1040 -49.26516 -35.426272
## I(pressure^3)         4.5648  11.39968  18.234542
## I(pressure^4)        -2.1248  -1.01964   0.085558
## QB300                -4.7565  -1.59419   1.568148
## pressure:QB300      -13.6410   1.70543  17.051845
## I(pressure^2):QB300 -17.9484   2.12680  22.201987
## I(pressure^3):QB300  -9.3503   0.47971  10.309706
## I(pressure^4):QB300  -1.8021  -0.22064   1.360833
## attr(,&quot;label&quot;)
## [1] &quot;Coefficients:&quot;
## 
##  Correlation structure:
##       lower   est.   upper
## Phi 0.62844 0.7526 0.83937
## attr(,&quot;label&quot;)
## [1] &quot;Correlation structure:&quot;
## 
##  Variance function:
##        lower    est.   upper
## power 0.3806 0.51824 0.65587
## attr(,&quot;label&quot;)
## [1] &quot;Variance function:&quot;
## 
##  Residual standard error:
##  lower   est.  upper 
## 2.5013 3.0463 3.7101</code></pre>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb532-1" data-line-number="1"><span class="kw">anova</span>(fm2Dial.gls, fm3Dial.gls)</a></code></pre></div>
<pre><code>##             Model df    AIC    BIC  logLik   Test L.Ratio
## fm2Dial.gls     1 12 738.22 772.63 -357.11               
## fm3Dial.gls     2 13 642.67 679.95 -308.34 1 vs 2  97.546
##             p-value
## fm2Dial.gls        
## fm3Dial.gls  &lt;.0001</code></pre>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb534-1" data-line-number="1"><span class="kw">anova</span>(fm3Dial.gls, fm2Dial.lme, <span class="dt">test =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>##             Model df    AIC    BIC  logLik
## fm3Dial.gls     1 13 642.67 679.95 -308.34
## fm2Dial.lme     2 18 655.01 706.63 -309.51</code></pre>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb536-1" data-line-number="1">fm1Wheat2 &lt;-<span class="st"> </span><span class="kw">gls</span>(yield <span class="op">~</span><span class="st"> </span>variety <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, Wheat2)</a>
<a class="sourceLine" id="cb536-2" data-line-number="2"><span class="kw">Variogram</span>(fm1Wheat2, <span class="dt">form =</span> <span class="op">~</span><span class="st"> </span>latitude <span class="op">+</span><span class="st"> </span>longitude)</a></code></pre></div>
<pre><code>##     variog    dist n.pairs
## 1  0.37026  4.3000    1143
## 2  0.39572  5.6080    1259
## 3  0.47019  8.3863    1263
## 4  0.50774  9.3231    1241
## 5  0.54502 10.5190    1242
## 6  0.63965 12.7472    1241
## 7  0.61183 13.3929    1283
## 8  0.65711 14.7635    1252
## 9  0.73844 16.1818    1221
## 10 0.72832 17.3666    1261
## 11 0.75117 18.4567    1288
## 12 0.87492 20.2428    1254
## 13 0.80516 21.6335    1256
## 14 0.87118 22.6736    1182
## 15 0.86812 24.6221    1257
## 16 0.85929 26.2427    1264
## 17 0.97088 28.5601    1235
## 18 0.99293 30.7877    1226
## 19 1.09617 34.5879    1263
## 20 1.34146 39.3641    1234</code></pre>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb538-1" data-line-number="1"><span class="kw">plot</span>(<span class="kw">Variogram</span>(fm1Wheat2, <span class="dt">form =</span> <span class="op">~</span><span class="st"> </span>latitude <span class="op">+</span><span class="st"> </span>longitude,</a>
<a class="sourceLine" id="cb538-2" data-line-number="2">      <span class="dt">maxDist =</span> <span class="dv">32</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">32</span>))</a></code></pre></div>
<p><img src="assets/unnamed-chunk-5-14.png" width="672" /></p>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb539-1" data-line-number="1">fm2Wheat2 &lt;-<span class="st"> </span><span class="kw">update</span>(fm1Wheat2, <span class="dt">corr =</span> <span class="kw">corSpher</span>(<span class="kw">c</span>(<span class="dv">28</span>, <span class="fl">0.2</span>),</a>
<a class="sourceLine" id="cb539-2" data-line-number="2">                               <span class="dt">form =</span> <span class="op">~</span><span class="st"> </span>latitude <span class="op">+</span><span class="st"> </span>longitude,</a>
<a class="sourceLine" id="cb539-3" data-line-number="3">                               <span class="dt">nugget =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb539-4" data-line-number="4">fm2Wheat2</a></code></pre></div>
<pre><code>## Generalized least squares fit by REML
##   Model: yield ~ variety - 1 
##   Data: Wheat2 
##   Log-restricted-likelihood: -533.93
## 
## Coefficients:
##   varietyARAPAHOE      varietyBRULE   varietyBUCKSKIN 
##            26.659            25.850            34.848 
##    varietyCENTURA  varietyCENTURK78   varietyCHEYENNE 
##            25.095            26.334            24.673 
##       varietyCODY       varietyCOLT       varietyGAGE 
##            22.489            25.184            24.321 
##  varietyHOMESTEAD   varietyKS831374     varietyLANCER 
##            21.669            26.856            23.333 
##    varietyLANCOTA    varietyNE83404    varietyNE83406 
##            21.291            24.049            25.314 
##    varietyNE83407    varietyNE83432    varietyNE83498 
##            25.192            21.818            28.705 
##    varietyNE83T12    varietyNE84557    varietyNE85556 
##            22.145            21.781            27.973 
##    varietyNE85623    varietyNE86482    varietyNE86501 
##            23.924            24.974            25.018 
##    varietyNE86503    varietyNE86507    varietyNE86509 
##            27.224            27.453            22.408 
##    varietyNE86527    varietyNE86582    varietyNE86606 
##            25.882            22.587            26.796 
##    varietyNE86607   varietyNE86T666    varietyNE87403 
##            25.910            16.787            21.490 
##    varietyNE87408    varietyNE87409    varietyNE87446 
##            24.319            26.320            22.219 
##    varietyNE87451    varietyNE87457    varietyNE87463 
##            24.191            23.536            23.226 
##    varietyNE87499    varietyNE87512    varietyNE87513 
##            22.173            22.575            21.825 
##    varietyNE87522    varietyNE87612    varietyNE87613 
##            19.483            27.391            27.562 
##    varietyNE87615    varietyNE87619    varietyNE87627 
##            23.819            28.485            18.480 
##     varietyNORKAN    varietyREDLAND varietyROUGHRIDER 
##            22.145            27.983            25.748 
##    varietySCOUT66  varietySIOUXLAND     varietyTAM107 
##            26.878            25.656            22.770 
##     varietyTAM200       varietyVONA 
##            18.764            24.782 
## 
## Correlation Structure: Spherical spatial correlation
##  Formula: ~latitude + longitude 
##  Parameter estimate(s):
##    range   nugget 
## 27.45748  0.20931 
## Degrees of freedom: 224 total; 168 residual
## Residual standard error: 7.4106</code></pre>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb541-1" data-line-number="1">fm3Wheat2 &lt;-<span class="st"> </span><span class="kw">update</span>(fm1Wheat2,</a>
<a class="sourceLine" id="cb541-2" data-line-number="2">                    <span class="dt">corr =</span> <span class="kw">corRatio</span>(<span class="kw">c</span>(<span class="fl">12.5</span>, <span class="fl">0.2</span>),</a>
<a class="sourceLine" id="cb541-3" data-line-number="3">                    <span class="dt">form =</span> <span class="op">~</span><span class="st"> </span>latitude <span class="op">+</span><span class="st"> </span>longitude, <span class="dt">nugget =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb541-4" data-line-number="4">fm3Wheat2</a></code></pre></div>
<pre><code>## Generalized least squares fit by REML
##   Model: yield ~ variety - 1 
##   Data: Wheat2 
##   Log-restricted-likelihood: -532.64
## 
## Coefficients:
##   varietyARAPAHOE      varietyBRULE   varietyBUCKSKIN 
##            26.546            26.284            35.037 
##    varietyCENTURA  varietyCENTURK78   varietyCHEYENNE 
##            24.867            26.695            24.430 
##       varietyCODY       varietyCOLT       varietyGAGE 
##            23.366            25.176            24.459 
##  varietyHOMESTEAD   varietyKS831374     varietyLANCER 
##            21.517            26.549            23.046 
##    varietyLANCOTA    varietyNE83404    varietyNE83406 
##            21.177            24.592            25.734 
##    varietyNE83407    varietyNE83432    varietyNE83498 
##            25.527            21.817            29.084 
##    varietyNE83T12    varietyNE84557    varietyNE85556 
##            21.576            21.321            27.917 
##    varietyNE85623    varietyNE86482    varietyNE86501 
##            23.739            24.373            24.879 
##    varietyNE86503    varietyNE86507    varietyNE86509 
##            27.300            27.366            22.174 
##    varietyNE86527    varietyNE86582    varietyNE86606 
##            24.989            23.274            27.317 
##    varietyNE86607   varietyNE86T666    varietyNE87403 
##            25.710            17.305            21.837 
##    varietyNE87408    varietyNE87409    varietyNE87446 
##            24.657            26.314            22.113 
##    varietyNE87451    varietyNE87457    varietyNE87463 
##            24.383            23.624            23.435 
##    varietyNE87499    varietyNE87512    varietyNE87513 
##            21.900            22.743            21.644 
##    varietyNE87522    varietyNE87612    varietyNE87613 
##            19.632            28.330            27.732 
##    varietyNE87615    varietyNE87619    varietyNE87627 
##            24.013            28.661            19.099 
##     varietyNORKAN    varietyREDLAND varietyROUGHRIDER 
##            22.684            27.670            25.619 
##    varietySCOUT66  varietySIOUXLAND     varietyTAM107 
##            26.289            25.740            22.476 
##     varietyTAM200       varietyVONA 
##            18.693            25.046 
## 
## Correlation Structure: Rational quadratic spatial correlation
##  Formula: ~latitude + longitude 
##  Parameter estimate(s):
##    range   nugget 
## 13.46134  0.19358 
## Degrees of freedom: 224 total; 168 residual
## Residual standard error: 8.8468</code></pre>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb543-1" data-line-number="1"><span class="kw">anova</span>(fm2Wheat2, fm3Wheat2)</a></code></pre></div>
<pre><code>##           Model df    AIC    BIC  logLik
## fm2Wheat2     1 59 1185.9 1370.2 -533.93
## fm3Wheat2     2 59 1183.3 1367.6 -532.64</code></pre>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb545-1" data-line-number="1"><span class="kw">anova</span>(fm1Wheat2, fm3Wheat2)</a></code></pre></div>
<pre><code>##           Model df    AIC    BIC  logLik   Test L.Ratio p-value
## fm1Wheat2     1 57 1354.7 1532.8 -620.37                       
## fm3Wheat2     2 59 1183.3 1367.6 -532.64 1 vs 2  175.46  &lt;.0001</code></pre>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb547-1" data-line-number="1"><span class="kw">plot</span>(<span class="kw">Variogram</span>(fm3Wheat2, <span class="dt">resType =</span> <span class="st">&quot;n&quot;</span>))</a></code></pre></div>
<p><img src="assets/unnamed-chunk-5-15.png" width="672" /></p>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb548-1" data-line-number="1"><span class="kw">plot</span>(fm3Wheat2, <span class="kw">resid</span>(., <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>) <span class="op">~</span><span class="st"> </span><span class="kw">fitted</span>(.), <span class="dt">abline =</span> <span class="dv">0</span>)</a></code></pre></div>
<p><img src="assets/unnamed-chunk-5-16.png" width="672" /></p>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb549-1" data-line-number="1"><span class="kw">qqnorm</span>(fm3Wheat2, <span class="op">~</span><span class="st"> </span><span class="kw">resid</span>(., <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>))</a></code></pre></div>
<p><img src="assets/unnamed-chunk-5-17.png" width="672" /></p>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb550-1" data-line-number="1">fm4Wheat2 &lt;-<span class="st"> </span><span class="kw">update</span>(fm3Wheat2, <span class="dt">model =</span> yield <span class="op">~</span><span class="st"> </span>variety)</a>
<a class="sourceLine" id="cb550-2" data-line-number="2"><span class="kw">anova</span>(fm4Wheat2)</a></code></pre></div>
<pre><code>## Denom. DF: 168 
##             numDF F-value p-value
## (Intercept)     1 30.3994  &lt;.0001
## variety        55  1.8509  0.0015</code></pre>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb552-1" data-line-number="1"><span class="kw">anova</span>(fm3Wheat2, <span class="dt">L =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))</a></code></pre></div>
<pre><code>## Denom. DF: 168 
##  F-test for linear combination(s)
## varietyARAPAHOE varietyBUCKSKIN 
##              -1               1 
##   numDF F-value p-value
## 1     1  7.6967  0.0062</code></pre>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb554-1" data-line-number="1"><span class="co"># cleanup</span></a>
<a class="sourceLine" id="cb554-2" data-line-number="2"></a>
<a class="sourceLine" id="cb554-3" data-line-number="3"><span class="kw">proc.time</span>()</a></code></pre></div>
<pre><code>##    user  system elapsed 
##   53.88    2.21   59.76</code></pre>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter-4.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter-6.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
